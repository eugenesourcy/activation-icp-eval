<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Golden Review (Cases + Transcripts) - Eugene V1</title>
  <style>
    :root {
      --bg: #f3efe5;
      --panel: #fffaf0;
      --line: #d7ccba;
      --ink: #1f2b2b;
      --muted: #5f6d6d;
      --brand: #126d60;
      --ok: #2f8e45;
      --warn: #b87400;
      --draft: #7a8690;
      --star: #d8832f;
      --shadow: 0 10px 30px rgba(20, 25, 27, 0.08);
      --user: #ecf5ff;
      --assistant: #ebfff5;
      --system: #fff7e9;
      --thinking: #f2f4f6;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      color: var(--ink);
      font-family: "Avenir Next", "Segoe UI", "Helvetica Neue", sans-serif;
      background:
        radial-gradient(860px 300px at 90% -15%, #ffd9b2 0%, transparent 70%),
        radial-gradient(1000px 450px at -10% 0%, #bfe5dd 0%, transparent 65%),
        var(--bg);
    }
    .wrap { max-width: 1380px; margin: 0 auto; padding: 16px; }
    .hero {
      border-radius: 14px;
      background: linear-gradient(135deg, #143534 0%, #126d60 50%, #28a38c 100%);
      color: #f3fffc;
      box-shadow: var(--shadow);
      padding: 16px;
    }
    .hero h1 { margin: 0 0 6px; font-size: clamp(22px, 3vw, 33px); }
    .hero p { margin: 0; color: #ddf9f3; font-size: 14px; }
    .kpis {
      margin-top: 12px;
      display: grid;
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 8px;
    }
    .card {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 10px;
      box-shadow: var(--shadow);
      padding: 10px;
    }
    .kpi .num { font-size: 24px; font-weight: 700; color: var(--brand); line-height: 1; margin-bottom: 4px; }
    .kpi .label {
      font-size: 12px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.7px;
      font-weight: 700;
    }
    h2 { margin: 18px 0 8px; font-size: 18px; }
    .priority-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }
    .starline {
      color: var(--star);
      font-size: 16px;
      letter-spacing: 1px;
      margin-bottom: 4px;
    }
    .tag {
      display: inline-block;
      font-size: 11px;
      border-radius: 999px;
      border: 1px solid #d6dede;
      background: #edf1f1;
      color: #4c5959;
      padding: 2px 8px;
      margin-right: 4px;
      margin-bottom: 4px;
    }
    .tag.locked { background: #e8f7eb; border-color: #bde3c5; color: var(--ok); }
    .tag.reviewed { background: #fff4e6; border-color: #f0d6b7; color: var(--warn); }
    .tag.draft { background: #eff2f4; border-color: #d5dde3; color: var(--draft); }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .heat-wrap, .table-wrap {
      overflow: auto;
      border: 1px solid var(--line);
      border-radius: 10px;
      background: var(--panel);
    }
    table {
      border-collapse: collapse;
      width: 100%;
      min-width: 760px;
    }
    th, td {
      border-bottom: 1px solid var(--line);
      border-right: 1px solid var(--line);
      padding: 8px 10px;
      font-size: 13px;
      text-align: left;
      vertical-align: top;
    }
    th {
      background: #ecf8f5;
      font-weight: 700;
      color: #173635;
    }
    tr:last-child td { border-bottom: 0; }
    tr td:last-child, tr th:last-child { border-right: 0; }
    .filters {
      margin-top: 8px;
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap: 8px;
    }
    .field {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 10px;
      box-shadow: var(--shadow);
      padding: 8px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.7px;
      color: var(--muted);
      font-weight: 700;
    }
    select, input {
      width: 100%;
      border: 1px solid #ccc0ad;
      border-radius: 8px;
      padding: 8px;
      background: #fffdf8;
      font: inherit;
      color: var(--ink);
    }
    .main {
      margin-top: 10px;
      display: grid;
      grid-template-columns: 440px 1fr;
      gap: 10px;
      min-height: 72vh;
    }
    .panel {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .panel h3 {
      margin: 0;
      padding: 10px 12px;
      border-bottom: 1px solid var(--line);
      background: #f8f2e5;
      font-size: 16px;
    }
    .case-list { overflow: auto; padding: 8px; }
    .case-item {
      border: 1px solid #e3d8c8;
      border-radius: 10px;
      padding: 9px;
      background: #fffdf8;
      cursor: pointer;
    }
    .case-item + .case-item { margin-top: 8px; }
    .case-item.active {
      border-color: #8dcbbf;
      box-shadow: inset 0 0 0 1px #8dcbbf;
      background: #eefbf7;
    }
    .case-item .t { font-size: 14px; font-weight: 700; margin-bottom: 5px; }
    .case-item .meta { font-size: 12px; color: var(--muted); margin-bottom: 6px; }
    .detail { overflow: auto; padding: 10px; }
    .detail-head {
      border: 1px solid #e3d8c8;
      border-radius: 10px;
      background: #fffdf8;
      padding: 10px;
      margin-bottom: 10px;
    }
    .detail-head h4 { margin: 0 0 6px; font-size: 20px; }
    .cols { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .box {
      border: 1px solid #e4dac9;
      border-radius: 10px;
      background: #fffdf8;
      overflow: hidden;
    }
    .box h5 {
      margin: 0;
      border-bottom: 1px solid #e4dac9;
      background: #fbf4e8;
      padding: 8px 10px;
      font-size: 14px;
    }
    .box .body {
      padding: 8px 10px;
      font-size: 13px;
      color: #263131;
    }
    .list-tight { margin: 0; padding-left: 16px; }
    .list-tight li + li { margin-top: 3px; }
    .check {
      display: inline-block;
      margin: 3px 4px 3px 0;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid #d9e1df;
      background: #eef5f3;
      font-size: 11px;
      color: #3c4d4c;
    }
    .timeline-wrap { margin-top: 10px; }
    .timeline-card {
      border: 1px solid #e3d8c8;
      border-radius: 10px;
      background: #fffdf8;
      padding: 10px;
      margin-bottom: 8px;
    }
    .timeline-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 6px;
    }
    .transcript-legend {
      margin: 8px 0 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .legend-pill {
      border: 1px solid #d8dedc;
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 11px;
      color: #41504f;
      background: #f0f4f3;
    }
    .legend-pill.user { background: var(--user); }
    .legend-pill.assistant { background: var(--assistant); }
    .legend-pill.internal { background: var(--system); }
    .legend-pill.thinking { background: var(--thinking); }
    .chat-line {
      display: flex;
      margin-bottom: 8px;
    }
    .chat-line.user { justify-content: flex-end; }
    .chat-line.assistant { justify-content: flex-start; }
    .chat-line.internal { justify-content: flex-start; }
    .chat-bubble {
      max-width: 80%;
      border: 1px solid #dfe5e3;
      border-radius: 12px;
      padding: 8px;
      font-size: 13px;
      line-height: 1.36;
      white-space: pre-wrap;
      background: #fff;
    }
    .chat-bubble.user { background: var(--user); border-color: #c9ddef; }
    .chat-bubble.assistant { background: var(--assistant); border-color: #cae6d9; }
    .internal-card {
      width: 100%;
      border: 1px solid #dfe5e3;
      border-radius: 10px;
      padding: 8px;
      font-size: 13px;
      line-height: 1.36;
      white-space: pre-wrap;
      background: var(--system);
    }
    .internal-card.thinking { background: var(--thinking); }
    .internal-card.transition { background: #f6f1e6; }
    .chat-head {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.7px;
      font-weight: 700;
      color: #5d6a69;
      margin-bottom: 4px;
    }
    .ui-preview {
      margin-top: 7px;
      border: 1px dashed #c6d1cf;
      border-radius: 8px;
      background: #f8fbfa;
      padding: 6px 8px;
      font-size: 12px;
      color: #344242;
    }
    .ui-preview-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.6px;
      font-weight: 700;
      color: #506160;
      margin-bottom: 4px;
    }
    .empty {
      padding: 18px;
      color: var(--muted);
      text-align: center;
      font-size: 14px;
    }
    @media (max-width: 1200px) {
      .main { grid-template-columns: 1fr; }
      .cols, .grid-2 { grid-template-columns: 1fr; }
      .priority-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 960px) {
      .filters { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .kpis { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 560px) {
      .filters, .kpis { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <section class="hero">
      <h1>Golden Review (Cases + Transcripts)</h1>
      <p id="heroMeta"></p>
    </section>

    <section class="kpis">
      <article class="card kpi"><div class="num" id="kCases">0</div><div class="label">Total Cases</div></article>
      <article class="card kpi"><div class="num" id="kTranscripts">0</div><div class="label">Transcripts</div></article>
      <article class="card kpi"><div class="num" id="kLinked">0</div><div class="label">Cases With Transcript</div></article>
      <article class="card kpi"><div class="num" id="kLocked">0</div><div class="label">Ready For Eval</div></article>
      <article class="card kpi"><div class="num" id="kDraft">0</div><div class="label">Needs Definition</div></article>
      <article class="card kpi"><div class="num" id="kToolCalls">0</div><div class="label">Transcript Tool Calls</div></article>
    </section>

    <section class="card" style="margin-top:10px;">
      <strong>Review Links:</strong>
      <a href="golden_eval_review.html" style="margin-left:8px;">Eval Framework + Eric Results</a>
      <a href="icp_eval_dashboard.html" style="margin-left:10px;">Eric Summary</a>
      <span style="margin-left:10px; font-size:13px; color:#596666;">All comparative scoring is centralized in <code>golden_eval_review.html</code>.</span>
    </section>

    

    <h2>Awsaf First Review</h2>
    <section class="priority-grid" id="priorityGrid"></section>

    <h2>Coverage Overview</h2>
    <div class="grid-2">
      <section class="card">
        <h3 style="margin:0 0 8px;">By Behavior Bucket (B1-B6)</h3>
        <div id="coverageSegment"></div>
      </section>
      <section class="card">
        <h3 style="margin:0 0 8px;">By Endpoint</h3>
        <div id="coverageEndpoint"></div>
      </section>
    </div>

    <h2>Coverage Heatmap (Persona Type x Product Mode)</h2>
    <div class="heat-wrap"><table id="heatTable"></table></div>

    <h2>Case Catalog</h2>
    <section class="filters">
      <div class="field"><label for="fPersona">Persona Type</label><select id="fPersona"></select></div>
      <div class="field"><label for="fMotivation">Motivation</label><select id="fMotivation"></select></div>
      <div class="field"><label for="fProductMode">Product Mode</label><select id="fProductMode"></select></div>
      <div class="field"><label for="fRisk">Risk Class</label><select id="fRisk"></select></div>
      <div class="field"><label for="fStatus">Review Status</label><select id="fStatus"></select></div>
      <div class="field"><label for="fTranscript">Transcript Link</label><select id="fTranscript"></select></div>
      <div class="field"><label for="fSearch">Search</label><input id="fSearch" placeholder="case id, title, notes"/></div>
    </section>

    <section class="main">
      <section class="panel">
        <h3>Case List</h3>
        <div id="caseList" class="case-list"></div>
      </section>
      <section class="panel">
        <h3>Case + Transcript Detail</h3>
        <div id="caseDetail" class="detail"><div class="empty">Select a case to inspect details.</div></div>
      </section>
    </section>

    <h2>Acceptance Criteria Catalog</h2>
    <div class="table-wrap"><table id="checkTable"></table></div>

    <h2>Case Review Board</h2>
    <div class="table-wrap"><table id="signoffTable"></table></div>
  </div>

  <script id="seed" type="application/json">{"dataset_name":"golden-eugene-v1-seed","version":"0.1.0","generated_for":"Team review before eval runs","cases":[{"case_id":"GD-001","title":"Job seeker asks how to apply","persona_type":"non_sourcing_or_spam","motivation":"unclear_or_non_buyer","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"unclear","risk_class":"out_of_scope","intent_level":"low","expected_endpoint":"EXIT_POLITE","expected_stage_path":["splash_to_stage1","off_topic_redirect","polite_exit"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Job or hiring information, not sourcing.","what_they_know":"Knows company name only.","what_they_dont_know":"Does not know this is a sourcing workflow.","communication_style":"Brief and transactional.","trust_questions":["Are you hiring?"],"dropoff_triggers":["Long answers","Forced sourcing questionnaire"]},"hidden_truth":{"quantity":"none","budget":"none","destination":"none","timeline":"none","flexibility":"none","notes":"Should be redirected out of flow quickly."},"allowed_disclosures_by_turn":["T1: asks about jobs only","T2: repeats job intent if pushed"],"must_pass_checks":["CK-012","CK-015","CK-020"],"must_fail_checks":["CK-011"],"review_status":"locked","review_notes":"Anchor non-buyer handling.","sources":["context/Bad/bad example 4.txt"],"behavior_bucket":"B6","bucket_pattern":"B6A","sourceability_status":"irrelevant","expected_dropoff_point":"after off-topic redirect","required_fields_for_sr":[],"linked_transcripts":[{"transcript_id":"TR-001","case_id":"GD-001","title":"Spam / Non-sourcing redirect","profile_band":"low-intent non-buyer","goal":"Demonstrate polite out-of-scope handling without tool usage.","expected_endpoint":"EXIT_POLITE","steps":[{"seq":1,"stage":"stage1","actor":"user","type":"message","text":"Are you hiring for remote jobs?"},{"seq":2,"stage":"stage1","actor":"assistant","type":"message","text":"Great question. I can help with sourcing requests. What product are you looking to source?"},{"seq":3,"stage":"stage1","actor":"user","type":"message","text":"No, I need a job."},{"seq":4,"stage":"stage1","actor":"assistant","type":"message","text":"Understood. This chat handles sourcing only, so please check Sourcy careers channels. If you need sourcing later, share product and quantity."}],"notes":["No product tools should be called.","Conversation stays concise and respectful.","Clear endpoint: polite exit."]}],"linked_transcript_count":1,"awsaf_priority_stars":5,"awsaf_priority_reason":"Non-buyer guardrail: proves polite scope control without wasting tools."},{"case_id":"GD-002","title":"Consumer wants 2-3 pieces retail purchase","persona_type":"non_sourcing_or_spam","motivation":"unclear_or_non_buyer","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"partial","risk_class":"out_of_scope","intent_level":"low","expected_endpoint":"EDUCATE_AND_NURTURE","expected_stage_path":["splash_to_stage1","scope_clarification","retail_redirect_exit"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Small personal purchase.","what_they_know":"Knows desired item category only.","what_they_dont_know":"Does not understand MOQ and B2B sourcing model.","communication_style":"Confused and short messages.","trust_questions":["Do you sell directly?","Can I buy 2 pieces?"],"dropoff_triggers":["Jargon-heavy reply","Condescending tone"]},"hidden_truth":{"quantity":"2-3 units","budget":"small retail budget","destination":"local","timeline":"immediate","flexibility":"not flexible","notes":"Correct endpoint is educational redirect."},"allowed_disclosures_by_turn":["T1: asks if bot sells products directly","T2: states tiny quantity"],"must_pass_checks":["CK-012","CK-015","CK-020"],"must_fail_checks":["CK-003","CK-011"],"review_status":"locked","review_notes":"Important for ad-click confused traffic.","sources":["tests/run-v4-fullsr/personas_testset.md"],"behavior_bucket":"B5","bucket_pattern":"B5A","sourceability_status":"blocked","expected_dropoff_point":"after MOQ/retail mismatch explained","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-003","title":"User asks what Sourcy is before sharing product","persona_type":"non_sourcing_or_spam","motivation":"start_business","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"partial","risk_class":"normal","intent_level":"medium","expected_endpoint":"QUALIFY_AND_ADVANCE","expected_stage_path":["splash_to_stage1","trust_answer_short","stage1_ask_reference_image","stage1_product_intelligence"],"expected_tool_sequence":["productIntelligence"],"persona_profile":{"what_they_want":"Understand service credibility before sharing details.","what_they_know":"Knows they want startup products.","what_they_dont_know":"Unsure how sourcing workflow works.","communication_style":"Cautious but cooperative.","trust_questions":["Who is Sourcy?","How are you different?"],"dropoff_triggers":["No direct trust answer","Immediate form-like questions"]},"hidden_truth":{"quantity":"500-1000 potential","budget":"not yet shared","destination":"Philippines","timeline":"2-3 months","flexibility":"moderate","notes":"Viable lead if trust is handled first."},"allowed_disclosures_by_turn":["T1: asks what Sourcy is","T2: shares product category after trust response"],"must_pass_checks":["CK-001","CK-002","CK-005","CK-012","CK-015"],"must_fail_checks":["CK-011"],"review_status":"reviewed","review_notes":"Common first-question pattern from inbound.","sources":["context/Trojan Horse Experiment_ WA Bot.md"],"behavior_bucket":"B2","bucket_pattern":"B2B","sourceability_status":"nurture","expected_dropoff_point":"if trust not resolved by turn 2","required_fields_for_sr":["product","quantity_or_budget","destination"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-004","title":"Spam crypto link with no product intent","persona_type":"non_sourcing_or_spam","motivation":"unclear_or_non_buyer","product_mode":"existing_no_custom","input_mode":"link","spec_clarity":"unclear","risk_class":"out_of_scope","intent_level":"low","expected_endpoint":"EXIT_POLITE","expected_stage_path":["splash_to_stage1","off_topic_redirect","polite_exit"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"No sourcing intent, likely spam.","what_they_know":"None relevant.","what_they_dont_know":"N/A","communication_style":"Link drop and one-line message.","trust_questions":[],"dropoff_triggers":["N/A"]},"hidden_truth":{"quantity":"none","budget":"none","destination":"none","timeline":"none","flexibility":"none","notes":"Should not consume tools."},"allowed_disclosures_by_turn":["T1: sends unrelated link","T2: may repeat or ghost"],"must_pass_checks":["CK-015","CK-020"],"must_fail_checks":["CK-003"],"review_status":"locked","review_notes":"Guard against wasted compute.","sources":["context/Bad/bad example 2.txt"],"behavior_bucket":"B6","bucket_pattern":"B6A","sourceability_status":"irrelevant","expected_dropoff_point":"after spam detection","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-005","title":"Handwash buyer with impossible target price","persona_type":"sourcing_moq_price_first","motivation":"expand_business","product_mode":"light_customization","input_mode":"text","spec_clarity":"clear","risk_class":"normal","intent_level":"medium","expected_endpoint":"EXIT_POLITE","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","stage3_refine_feasibility","economics_based_exit"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"500ml handwash with branding at very low price.","what_they_know":"Knows category and target price.","what_they_dont_know":"True landed cost constraints.","communication_style":"Direct and persistent.","trust_questions":["MOQ?","Price?","Delivery?"],"dropoff_triggers":["Vague answer","No concrete economics"]},"hidden_truth":{"quantity":"3000 initially","budget":"25-30 PKR per unit target","destination":"Karachi","timeline":"6 weeks","flexibility":"can stretch if justified","notes":"Exit should leave specific re-entry price door."},"allowed_disclosures_by_turn":["T1: asks trust stack with target price","T2: asks if sourcing is possible at that target","T3: may accept higher range if math shown"],"must_pass_checks":["CK-001","CK-002","CK-003","CK-008","CK-014","CK-015"],"must_fail_checks":["CK-018"],"review_status":"locked","review_notes":"Core economics honesty case.","sources":["context/Good/handwash SR.txt"],"behavior_bucket":"B2","bucket_pattern":"B2C","sourceability_status":"nurture","expected_dropoff_point":"after economics mismatch shown","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-006","title":"MOQ/price first with viable budget and startup brand","persona_type":"sourcing_moq_price_first","motivation":"start_business","product_mode":"light_customization","input_mode":"text","spec_clarity":"partial","risk_class":"normal","intent_level":"high","expected_endpoint":"COMPLETE_SR","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","stage3_refine_feasibility","stage4_contact_finalize"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"Custom product pricing, MOQ, and feasible launch plan.","what_they_know":"Category and launch intent.","what_they_dont_know":"Material tradeoffs and landed cost structure.","communication_style":"Serious but concise.","trust_questions":["Can this budget work?","What MOQ do I need?"],"dropoff_triggers":["No direct numbers","Long process lecture"]},"hidden_truth":{"quantity":"1000-2000","budget":"$4,000 total","destination":"Mexico","timeline":"2 months","flexibility":"medium","notes":"Should proceed to finalized request."},"allowed_disclosures_by_turn":["T1: asks price and MOQ first","T2: shares budget when trust established","T3+: provides remaining requirements"],"must_pass_checks":["CK-003","CK-005","CK-008","CK-014","CK-017","CK-015"],"must_fail_checks":["CK-011"],"review_status":"reviewed","review_notes":"Happy-path conversion benchmark.","sources":["context/Good/Jesús Lizandro Mendoza Mora chat history (Inbound).txt"],"behavior_bucket":"B3","bucket_pattern":"B3A","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity","destination","timeline","contact_email"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-007","title":"Call-first pastry packaging lead","persona_type":"sourcing_moq_price_first","motivation":"expand_business","product_mode":"light_customization","input_mode":"text","spec_clarity":"clear","risk_class":"normal","intent_level":"high","expected_endpoint":"HUMAN_HANDOFF","expected_stage_path":["splash_to_stage1","call_request_received","handoff_offer_with_light_qualification"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Zoom/call scheduling for packaging sourcing.","what_they_know":"Knows category and likely quantities.","what_they_dont_know":"Needs supplier options and pricing by call.","communication_style":"Professional and brief.","trust_questions":["Can we do a call?"],"dropoff_triggers":["Denial of call","Forced long chat"]},"hidden_truth":{"quantity":"5000 each SKU","budget":"reasonable","destination":"Philippines","timeline":"soon","flexibility":"high","notes":"Must not deny call capability."},"allowed_disclosures_by_turn":["T1: asks for call/zoom directly","T2: provides time and email if handoff offered"],"must_pass_checks":["CK-010","CK-012","CK-015"],"must_fail_checks":["CK-018"],"review_status":"locked","review_notes":"Protects known v1 failure mode.","sources":["context/Good/P1 PH leads asking for a call.txt"],"behavior_bucket":"B4","bucket_pattern":"B4A","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","contact_email_or_call_slot"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-008","title":"Zero-spec dreamer with no budget knowledge","persona_type":"sourcing_moq_price_first","motivation":"start_business","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"unclear","risk_class":"normal","intent_level":"medium","expected_endpoint":"EDUCATE_AND_NURTURE","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","nurture_without_forcing_close"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration"],"persona_profile":{"what_they_want":"Understand what to source and how much it costs.","what_they_know":"Category-level only.","what_they_dont_know":"Specs, quantity, target budget.","communication_style":"Very short responses.","trust_questions":["How much investment needed?"],"dropoff_triggers":["Asked for target price repeatedly","Hard rejection too early"]},"hidden_truth":{"quantity":"unknown","budget":"unknown","destination":"Pakistan","timeline":"flexible","flexibility":"low clarity, medium intent","notes":"Bot should estimate options, not interrogate."},"allowed_disclosures_by_turn":["T1: broad category only","T2: no reference","T3+: still minimal detail"],"must_pass_checks":["CK-002","CK-003","CK-005","CK-015"],"must_fail_checks":["CK-011"],"review_status":"reviewed","review_notes":"Needs value-first with low-effort user burden.","sources":["context/Bad/bad example 2.txt"],"behavior_bucket":"B2","bucket_pattern":"B2A","sourceability_status":"nurture","expected_dropoff_point":"after user cannot provide specs/budget","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-009","title":"Alibaba veteran challenges markup","persona_type":"sourcing_with_alibaba_link","motivation":"find_cheaper","product_mode":"existing_no_custom","input_mode":"mixed","spec_clarity":"clear","risk_class":"normal","intent_level":"medium","expected_endpoint":"QUALIFY_AND_ADVANCE","expected_stage_path":["splash_to_stage1","value_differentiation","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration"],"persona_profile":{"what_they_want":"Proof Sourcy can outperform or de-risk Alibaba.","what_they_know":"Knows current unit costs and supplier channels.","what_they_dont_know":"Whether Sourcy offers real edge.","communication_style":"Skeptical and direct.","trust_questions":["Why pay Sourcy markup?"],"dropoff_triggers":["Vague claims","No concrete comparison logic"]},"hidden_truth":{"quantity":"1000+","budget":"has benchmark price","destination":"US","timeline":"standard","flexibility":"low unless value proven","notes":"Must avoid fake price promises."},"allowed_disclosures_by_turn":["T1: names current Alibaba cost","T2: asks direct differentiation question","T3: shares destination if handled well"],"must_pass_checks":["CK-005","CK-008","CK-012","CK-015","CK-018"],"must_fail_checks":["CK-011"],"review_status":"reviewed","review_notes":"Key trust stress test.","sources":["tests/run-v4-fullsr/personas_testset.md"],"behavior_bucket":"B3","bucket_pattern":"B3B","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity_or_budget","destination"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-010","title":"UK dog harness with Alibaba link and clear MOQ","persona_type":"sourcing_with_alibaba_link","motivation":"expand_business","product_mode":"light_customization","input_mode":"link","spec_clarity":"clear","risk_class":"normal","intent_level":"high","expected_endpoint":"COMPLETE_SR","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","stage3_refine_feasibility","stage4_contact_finalize"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"Custom branded harness sourcing for 500 units.","what_they_know":"Provides reference link and quantity early.","what_they_dont_know":"Material and landed-cost tradeoffs.","communication_style":"Business-like and efficient.","trust_questions":["Can you help with this exact reference?"],"dropoff_triggers":["Slow movement","No numbers"]},"hidden_truth":{"quantity":"500","budget":"market-aligned","destination":"UK","timeline":"6-8 weeks","flexibility":"high","notes":"Should convert with minimal friction."},"allowed_disclosures_by_turn":["T1: shares link and quantity","T2: shares material preference if asked"],"must_pass_checks":["CK-001","CK-002","CK-003","CK-014","CK-017","CK-015"],"must_fail_checks":[],"review_status":"locked","review_notes":"High-intent link-led conversion case.","sources":["tests/run-v3-test/results/t-uk-dog.jsonl"],"behavior_bucket":"B4","bucket_pattern":"B4A","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity","destination","timeline","contact_email"],"linked_transcripts":[{"transcript_id":"TR-003","case_id":"GD-010","title":"High-intent link-led ICP flow","profile_band":"high-intent qualified ICP","goal":"Demonstrate fast progression from clear lead input to complete SR with correct stage/tool orchestration.","expected_endpoint":"COMPLETE_SR","steps":[{"seq":1,"stage":"stage1","actor":"user","type":"message","text":"I need custom dog harnesses, 500 units. Reference link: Alibaba listing above."},{"seq":2,"stage":"stage1","actor":"assistant","type":"message","text":"Great brief. Do you have a reference image? Upload one, or say skip so I can run product analysis."},{"seq":3,"stage":"stage1","actor":"user","type":"message","text":"Skip. Use the link details."},{"seq":4,"stage":"stage1","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"userDescription from link context (no image)"},{"seq":5,"stage":"stage1","actor":"assistant","type":"message","text":"Here are common options for this product. Pick what fits — or type specifics in chat."},{"seq":6,"stage":"stage1","actor":"user","type":"message","text":"Confirmed customizations: material=nylon+mesh, branding=woven label, color=black+orange."},{"seq":7,"stage":"stage1_to_stage2","actor":"system","type":"state_transition","state_update":"step1Complete=true, stage=2"},{"seq":8,"stage":"stage2","actor":"assistant","type":"message","text":"Building your offering now. I’ll run product, pricing, and concepts, then you can pick one."},{"seq":9,"stage":"stage2","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"locked customizations and harness context"},{"seq":10,"stage":"stage2","actor":"assistant","type":"thinking","text":"This specification is production-ready. Nylon mesh balances durability and comfort. Woven labels scale well at this MOQ."},{"seq":11,"stage":"stage2","actor":"system","type":"tool_call","tool":"pricingIntelligence","input_summary":"product + selected specs + quantity signal"},{"seq":12,"stage":"stage2","actor":"assistant","type":"thinking","text":"At 500 units, pricing should be stable. Material and buckle quality are primary cost drivers. Destination will sharpen landed range."},{"seq":13,"stage":"stage2","actor":"system","type":"tool_call","tool":"visualConceptGeneration","input_summary":"harness design direction + custom colors + branding"},{"seq":14,"stage":"stage2","actor":"assistant","type":"message","text":"Your offering is ready — $4.30-$5.70 DDP. Pick a visual concept below."},{"seq":15,"stage":"stage2_to_stage3","actor":"user","type":"message","text":"Picked concept 1."},{"seq":16,"stage":"stage3","actor":"assistant","type":"message","text":"Great choice! Your estimate is $4.30-$5.70/unit. Fill in the details below to refine."},{"seq":17,"stage":"stage3","actor":"user","type":"message","text":"Quantity: 500, Destination: UK, Timeline: 6 weeks"},{"seq":18,"stage":"stage3","actor":"system","type":"tool_call","tool":"feasibilityAssessment","input_summary":"quantity + destination + timeline + current pricing"},{"seq":19,"stage":"stage3","actor":"system","type":"tool_result","tool":"feasibilityAssessment","output_summary":"Status: green. Feasible with current specs and timeline."},{"seq":20,"stage":"stage3","actor":"assistant","type":"message","text":"Feasibility looks good. Want to add another product, or ready to finalize?"},{"seq":21,"stage":"stage3_to_stage4","actor":"user","type":"message","text":"Finalize."},{"seq":22,"stage":"stage4","actor":"assistant","type":"message","text":"Let's finalize — please fill in your details below."},{"seq":23,"stage":"stage4","actor":"user","type":"message","text":"Name: Roy Weissbach, Email: roy@brand.co, Company: UK Pet Co, Phone: +44..."},{"seq":24,"stage":"complete","actor":"assistant","type":"message","text":"Confirmed: custom dog harness, 500 units, delivery to UK. Your sourcing request is finalized for supplier quoting."}],"notes":["Uses skip branch correctly before PI in stage 1.","Stage 2 includes AHA close with DDP mention.","Stage 4 transition text is exact and isolated."]}],"linked_transcript_count":1,"awsaf_priority_stars":5,"awsaf_priority_reason":"High-intent ICP: clean path to complete SR with correct tool ordering."},{"case_id":"GD-011","title":"Price shopper says competitor is cheaper","persona_type":"sourcing_with_alibaba_link","motivation":"find_cheaper","product_mode":"light_customization","input_mode":"mixed","spec_clarity":"partial","risk_class":"normal","intent_level":"high","expected_endpoint":"QUALIFY_AND_ADVANCE","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","competitive_reframe"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration"],"persona_profile":{"what_they_want":"Fast cheapest landed option.","what_they_know":"Has rough benchmark from 1688/Alibaba.","what_they_dont_know":"Full landed and risk-adjusted cost.","communication_style":"Fast, terse, comparison-driven.","trust_questions":["I found $3/unit elsewhere. Can you beat it?"],"dropoff_triggers":["Delays","No competitive framing in first two turns"]},"hidden_truth":{"quantity":"500","budget":"tight","destination":"Philippines","timeline":"urgent","flexibility":"low","notes":"Can stay only if response is fast and honest."},"allowed_disclosures_by_turn":["T1: mentions benchmark price","T2: asks direct beat-or-not","T3: may ghost if low confidence"],"must_pass_checks":["CK-005","CK-008","CK-012","CK-015"],"must_fail_checks":["CK-018"],"review_status":"reviewed","review_notes":"Speed-plus-honesty case.","sources":["tests/run-v4-fullsr/personas_testset.md"],"behavior_bucket":"B3","bucket_pattern":"B3C","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity_or_budget","destination"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-012","title":"Burned buyer asks trust and QC proof","persona_type":"sourcing_with_alibaba_link","motivation":"expand_business","product_mode":"light_customization","input_mode":"text","spec_clarity":"partial","risk_class":"normal","intent_level":"medium","expected_endpoint":"QUALIFY_AND_ADVANCE","expected_stage_path":["splash_to_stage1","trust_concern_acknowledged","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration"],"persona_profile":{"what_they_want":"Safe sourcing path after prior scam.","what_they_know":"Knows pain points from failed agency.","what_they_dont_know":"How Sourcy risk controls differ.","communication_style":"Careful and skeptical.","trust_questions":["How do you prevent scams?","What QC proof do I get?"],"dropoff_triggers":["Generic reassurance","Opaque process claims"]},"hidden_truth":{"quantity":"1000","budget":"viable","destination":"US","timeline":"2-3 months","flexibility":"medium","notes":"Needs direct acknowledgement of prior bad experience."},"allowed_disclosures_by_turn":["T1: discloses past scam","T2: asks for concrete safeguards","T3: shares specs only if trust answered"],"must_pass_checks":["CK-005","CK-012","CK-015","CK-018"],"must_fail_checks":[],"review_status":"reviewed","review_notes":"Trust-heavy scenario.","sources":["tests/run-v4-fullsr/personas_testset.md"],"behavior_bucket":"B3","bucket_pattern":"B3D","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity_or_budget","destination"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-013","title":"Teen jewelry founder sends image references","persona_type":"sourcing_with_image_reference","motivation":"start_business","product_mode":"light_customization","input_mode":"image","spec_clarity":"partial","risk_class":"normal","intent_level":"medium","expected_endpoint":"COMPLETE_SR","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","stage3_refine_feasibility","stage4_contact_finalize"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"Budget-friendly starter order for IG jewelry brand.","what_they_know":"Aesthetic and style references.","what_they_dont_know":"Investment math and MOQ realities.","communication_style":"Polite, paragraph style.","trust_questions":["How much should I invest?","How does process work?"],"dropoff_triggers":["Asked for target price repeatedly","Dismissed as too new"]},"hidden_truth":{"quantity":"200-300 mixed pieces","budget":"not known by user","destination":"Pakistan","timeline":"flexible","flexibility":"medium","notes":"Bot should estimate, not demand missing budget."},"allowed_disclosures_by_turn":["T1: asks for investment guidance","T2: sends image references and style constraints","T3: says no target price yet"],"must_pass_checks":["CK-002","CK-003","CK-008","CK-015","CK-017"],"must_fail_checks":["CK-011"],"review_status":"locked","review_notes":"Must preserve medium-intent early founder leads and convert viable requests.","sources":["context/Bad/bad example 5 - femmoraaa jewelry teenager.txt"],"behavior_bucket":"B2","bucket_pattern":"B2B","sourceability_status":"nurture","expected_dropoff_point":"if budget/qty not clarified in stage 3","required_fields_for_sr":["product","quantity","destination","timeline","contact_email"],"linked_transcripts":[{"transcript_id":"TR-002","case_id":"GD-013","title":"Image-led medium-intent founder flow","profile_band":"mid-intent startup ICP","goal":"Show complete stage behavior with image upload, AHA sequence, feasibility, and stage-4 contact flow.","expected_endpoint":"COMPLETE_SR","steps":[{"seq":1,"stage":"stage1","actor":"user","type":"message","text":"I want to source minimalist gold jewelry for my new Instagram brand."},{"seq":2,"stage":"stage1","actor":"assistant","type":"message","text":"Great category. Do you have a reference image? Upload one, or say skip so I can run product analysis."},{"seq":3,"stage":"stage1","actor":"user","type":"message","text":"[Reference image uploaded]"},{"seq":4,"stage":"stage1","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"userDescription + imageBase64=pending"},{"seq":5,"stage":"stage1","actor":"system","type":"tool_result","tool":"productIntelligence","output_summary":"Product identified: stainless PVD jewelry. Chip groups: material, branding, color. MOQ guidance included."},{"seq":6,"stage":"stage1","actor":"assistant","type":"message","text":"Here are common options for this product. Pick what fits — or type specifics in chat."},{"seq":7,"stage":"stage1","actor":"user","type":"message","text":"Confirmed customizations: material=PVD stainless, branding=logo card, color=gold."},{"seq":8,"stage":"stage1_to_stage2","actor":"system","type":"state_transition","state_update":"step1Complete=true, stage=2"},{"seq":9,"stage":"stage2","actor":"assistant","type":"message","text":"Building your offering now. I’ll run product, pricing, and concepts, then you can pick one."},{"seq":10,"stage":"stage2","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"selected customizations + current product context"},{"seq":11,"stage":"stage2","actor":"assistant","type":"thinking","text":"This is a style-sensitive jewelry SKU. PVD improves durability for daily wear. Branding via card keeps MOQ practical."},{"seq":12,"stage":"stage2","actor":"system","type":"tool_call","tool":"pricingIntelligence","input_summary":"product + specs + customizations"},{"seq":13,"stage":"stage2","actor":"system","type":"tool_result","tool":"pricingIntelligence","output_summary":"Sourcy DDP range generated with cost tips and destination estimates."},{"seq":14,"stage":"stage2","actor":"assistant","type":"thinking","text":"Pricing is competitive for starter quantity. Biggest lever is order volume per design. Logistics remains manageable for this category."},{"seq":15,"stage":"stage2","actor":"system","type":"tool_call","tool":"visualConceptGeneration","input_summary":"product + specs + customizations"},{"seq":16,"stage":"stage2","actor":"system","type":"tool_result","tool":"visualConceptGeneration","output_summary":"3 concept labels rendered with images and prompts."},{"seq":17,"stage":"stage2","actor":"assistant","type":"thinking","text":"Concepts vary by finish and silhouette while preserving your minimal aesthetic. This helps validate fit before refinement."},{"seq":18,"stage":"stage2","actor":"assistant","type":"message","text":"Your offering is ready — $1.90-$3.60 DDP. Pick a visual concept below."},{"seq":19,"stage":"stage2_to_stage3","actor":"user","type":"message","text":"I picked concept 2. Let's refine."},{"seq":20,"stage":"stage3","actor":"assistant","type":"message","text":"Great choice! Your estimate is $1.90-$3.60/unit. Fill in the details below to refine."},{"seq":21,"stage":"stage3","actor":"user","type":"message","text":"Quantity: 300, Destination: Pakistan, Timeline: 8 weeks"},{"seq":22,"stage":"stage3","actor":"system","type":"tool_call","tool":"feasibilityAssessment","input_summary":"quantity + destination + timeline + pricing context"},{"seq":23,"stage":"stage3","actor":"system","type":"tool_result","tool":"feasibilityAssessment","output_summary":"Status: yellow. Suggestion: increase MOQ or simplify finish for lower unit cost."},{"seq":24,"stage":"stage3","actor":"assistant","type":"message","text":"Feasibility is workable with small adjustments. Want to add another product, or ready to finalize?"},{"seq":25,"stage":"stage3_to_stage4","actor":"user","type":"message","text":"Ready to finalize."},{"seq":26,"stage":"stage4","actor":"assistant","type":"message","text":"Let's finalize — please fill in your details below."},{"seq":27,"stage":"stage4","actor":"user","type":"message","text":"Name: Fatima, Email: fatima@femmoraaa.co, Company: femmoraaa, Phone: +92..."},{"seq":28,"stage":"complete","actor":"assistant","type":"message","text":"Confirmed: PVD jewelry, 300 units, delivery to Pakistan. We’ll proceed with supplier outreach and send next steps."}],"notes":["No pricing/visual tools are called before step1Complete.","Feasibility is called immediately after structured form message.","No contact request appears before stage 4."]}],"linked_transcript_count":1,"awsaf_priority_stars":5,"awsaf_priority_reason":"Mid-intent image-led: validates full stage choreography and conversion hygiene."},{"case_id":"GD-014","title":"Image-led exact match with custom logo and clear quantity","persona_type":"sourcing_with_image_reference","motivation":"expand_business","product_mode":"light_customization","input_mode":"image","spec_clarity":"clear","risk_class":"normal","intent_level":"high","expected_endpoint":"COMPLETE_SR","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","stage3_refine_feasibility","stage4_contact_finalize"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"Exact style matching with branding and reliable delivery.","what_they_know":"Reference visuals and target quantity.","what_they_dont_know":"Detailed production tradeoffs.","communication_style":"Procurement-style, direct.","trust_questions":["Can you match this exactly?"],"dropoff_triggers":["No acknowledgement of image details","Slow timeline answers"]},"hidden_truth":{"quantity":"2000","budget":"viable","destination":"US","timeline":"event date fixed","flexibility":"medium","notes":"Strong conversion scenario."},"allowed_disclosures_by_turn":["T1: sends image and quantity","T2: clarifies logo method and timeline if asked"],"must_pass_checks":["CK-002","CK-003","CK-014","CK-017","CK-015"],"must_fail_checks":[],"review_status":"reviewed","review_notes":"Benchmark for image-first conversions.","sources":["context/Good/WhatsApp Chat - Sourcy __ Bala Di Gala (1).txt"],"behavior_bucket":"B4","bucket_pattern":"B4A","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity","destination","timeline","contact_email"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-015","title":"Image sent but user has no specs and no budget","persona_type":"sourcing_with_image_reference","motivation":"start_business","product_mode":"existing_no_custom","input_mode":"image","spec_clarity":"unclear","risk_class":"normal","intent_level":"medium","expected_endpoint":"EDUCATE_AND_NURTURE","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","nurture_without_hard_block"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration"],"persona_profile":{"what_they_want":"Figure out feasibility and starter direction.","what_they_know":"Only visual taste.","what_they_dont_know":"Specs, price target, quantity.","communication_style":"Short and uncertain.","trust_questions":["What do I need to start?"],"dropoff_triggers":["Too many technical questions early","Immediate disqualification"]},"hidden_truth":{"quantity":"unknown","budget":"unknown","destination":"Indonesia","timeline":"exploratory","flexibility":"high uncertainty","notes":"Should receive guided options."},"allowed_disclosures_by_turn":["T1: sends image only","T2: says no budget and no quantity yet"],"must_pass_checks":["CK-002","CK-003","CK-015"],"must_fail_checks":["CK-020"],"review_status":"draft","review_notes":"Need team decision on exit vs nurture threshold.","sources":["context/Good/Edamama.txt"],"behavior_bucket":"B2","bucket_pattern":"B2A","sourceability_status":"nurture","expected_dropoff_point":"after repeated unknown specs/budget","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-016","title":"Image and text indicate restricted battery request","persona_type":"sourcing_with_image_reference","motivation":"find_cheaper","product_mode":"existing_no_custom","input_mode":"image","spec_clarity":"clear","risk_class":"restricted","intent_level":"medium","expected_endpoint":"EXIT_POLITE","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","restriction_disclosure","allowed_alternative_pivot","exit_or_redirect"],"expected_tool_sequence":["productIntelligence"],"persona_profile":{"what_they_want":"Battery sourcing plus related electrical parts.","what_they_know":"Knows exact SKU and wants original units.","what_they_dont_know":"International hazardous logistics constraints.","communication_style":"Pushy and confident.","trust_questions":["Import is allowed in my country, why not?"],"dropoff_triggers":["Unclear reason for refusal"]},"hidden_truth":{"quantity":"small","budget":"low","destination":"Pakistan","timeline":"soon","flexibility":"low","notes":"Must not reverse restriction under pushback."},"allowed_disclosures_by_turn":["T1: asks for battery sourcing","T2: pushes back on restriction rationale","T3: may accept pivot to allowed components"],"must_pass_checks":["CK-006","CK-012","CK-015"],"must_fail_checks":["CK-003"],"review_status":"locked","review_notes":"Critical compliance lock case.","sources":["context/Bad/bad example 3.txt"],"behavior_bucket":"B5","bucket_pattern":"B5C","sourceability_status":"blocked","expected_dropoff_point":"after restriction explanation + safe alternative","required_fields_for_sr":[],"linked_transcripts":[{"transcript_id":"TR-004","case_id":"GD-016","title":"Restricted battery request with pushback","profile_band":"compliance-critical lead","goal":"Show firm restricted-category hold with clear rationale and safe pivot options.","expected_endpoint":"EXIT_POLITE","steps":[{"seq":1,"stage":"stage1","actor":"user","type":"message","text":"Need Long 12/7 original batteries. Can source?"},{"seq":2,"stage":"stage1","actor":"assistant","type":"message","text":"Got it. Do you have a reference image? Upload one or just say skip."},{"seq":3,"stage":"stage1","actor":"user","type":"message","text":"[Reference image uploaded]"},{"seq":4,"stage":"stage1","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"battery request + imageBase64=pending"},{"seq":5,"stage":"stage1","actor":"system","type":"tool_result","tool":"productIntelligence","output_summary":"Product classified as lead-acid battery; related accessories recognized."},{"seq":6,"stage":"stage1","actor":"assistant","type":"message","text":"I can’t support battery sourcing due dangerous-goods shipping restrictions. To avoid seizure risk, I must decline this request. Should I close this now?"},{"seq":7,"stage":"stage1","actor":"user","type":"message","text":"Importing batteries here is allowed. Why not source?"},{"seq":8,"stage":"stage1","actor":"assistant","type":"message","text":"Understood. Even if local import is allowed, carrier and transit safety rules still block this lane. Should I close this battery request now?"},{"seq":9,"stage":"stage1","actor":"assistant","type":"message","text":"Thanks for understanding. Do you want to continue with a non-restricted product instead?"},{"seq":10,"stage":"stage1","actor":"user","type":"message","text":"No, that is fine."},{"seq":11,"stage":"stage1","actor":"assistant","type":"message","text":"Appreciate it. We can’t ship batteries under dangerous-goods rules, so this request stays closed. When ready, tell me product and quantity."}],"notes":["No pricing/visual tools should run for restricted battery request.","Restriction stays firm under pushback.","Outcome is compliant, polite exit with optional safe pivot."]}],"linked_transcript_count":1,"awsaf_priority_stars":4,"awsaf_priority_reason":"Compliance lock: restricted-category hold under pushback."},{"case_id":"GD-017","title":"Text-only sportswear lead asking for catalog","persona_type":"sourcing_text_only","motivation":"start_business","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"partial","risk_class":"normal","intent_level":"high","expected_endpoint":"COMPLETE_SR","expected_stage_path":["splash_to_stage1","catalog_question_handled","stage1_product_intelligence","stage2_aha_sequence","stage3_refine_feasibility","stage4_contact_finalize"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"Understand options and costs before opening store.","what_they_know":"Category and total budget.","what_they_dont_know":"How catalog-less sourcing works.","communication_style":"Friendly and pragmatic.","trust_questions":["Do you have catalog?"],"dropoff_triggers":["No visual/option confidence","Rejected for no company"]},"hidden_truth":{"quantity":"300 pairs equivalent","budget":"70k MXN equivalent","destination":"Mexico","timeline":"near-term","flexibility":"good","notes":"Should not fail on no-company signal."},"allowed_disclosures_by_turn":["T1: asks for catalog","T2: shares budget and categories","T3: says no company but opening store"],"must_pass_checks":["CK-005","CK-008","CK-009","CK-014","CK-017","CK-015"],"must_fail_checks":["CK-020"],"review_status":"locked","review_notes":"Protects against false-negative qualification.","sources":["context/Good/Jesús Lizandro Mendoza Mora chat history (Inbound).txt"],"behavior_bucket":"B3","bucket_pattern":"B3A","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity","destination","timeline","contact_email"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-018","title":"Text-only net-new product invention request","persona_type":"sourcing_text_only","motivation":"start_business","product_mode":"net_new_invention","input_mode":"text","spec_clarity":"unclear","risk_class":"normal","intent_level":"medium","expected_endpoint":"HUMAN_HANDOFF","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","complexity_flag","human_handoff_offer"],"expected_tool_sequence":["productIntelligence"],"persona_profile":{"what_they_want":"Create product that does not currently exist.","what_they_know":"Business problem, not technical specs.","what_they_dont_know":"Engineering and tooling constraints.","communication_style":"Visionary, broad statements.","trust_questions":["Can you build this from scratch?"],"dropoff_triggers":["Overpromising","No realistic next-step framing"]},"hidden_truth":{"quantity":"unknown","budget":"unknown","destination":"US","timeline":"aggressive","flexibility":"unknown","notes":"Should route to high-touch path."},"allowed_disclosures_by_turn":["T1: describes novel concept vaguely","T2: asks if full invention is possible","T3: shares rough market and use case"],"must_pass_checks":["CK-002","CK-010","CK-015","CK-018"],"must_fail_checks":[],"review_status":"draft","review_notes":"Needs team policy on invention boundaries.","sources":["context/Trojan Horse Experiment_ WA Bot.md"],"behavior_bucket":"B5","bucket_pattern":"B5D","sourceability_status":"blocked","expected_dropoff_point":"after complexity/tooling boundary set","required_fields_for_sr":["product","contact_email_or_call_slot"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-019","title":"Text-only custom size requiring mold and tooling","persona_type":"sourcing_text_only","motivation":"expand_business","product_mode":"custom_mold","input_mode":"text","spec_clarity":"partial","risk_class":"normal","intent_level":"high","expected_endpoint":"QUALIFY_AND_ADVANCE","expected_stage_path":["splash_to_stage1","stage1_ask_reference_image","stage1_product_intelligence","stage2_aha_sequence","stage3_refine_feasibility"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"Custom dimensions and tooling for differentiated SKU.","what_they_know":"Target market and desired specs.","what_they_dont_know":"Mold fee impact and lead time.","communication_style":"Detailed and technical.","trust_questions":["How much does mold cost?","How long to production?"],"dropoff_triggers":["No mention of tooling impact","Unclear timeline risk"]},"hidden_truth":{"quantity":"5000 after validation","budget":"viable but cost-sensitive","destination":"UK","timeline":"3 months","flexibility":"medium","notes":"Should produce yellow/green feasibility with adjustments."},"allowed_disclosures_by_turn":["T1: provides custom spec request","T2: asks about mold fee and MOQ","T3: gives timeline and destination"],"must_pass_checks":["CK-003","CK-008","CK-014","CK-015"],"must_fail_checks":["CK-018"],"review_status":"reviewed","review_notes":"Important for custom engineering paths.","sources":["context/Decision Backlog 1 2efda18fc0a580e3be46e703ba9c9d79_all.csv"],"behavior_bucket":"B3","bucket_pattern":"B3E","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity_or_budget","destination"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-020","title":"Multi-product flow with add-another-product loop","persona_type":"sourcing_text_only","motivation":"expand_business","product_mode":"light_customization","input_mode":"mixed","spec_clarity":"clear","risk_class":"normal","intent_level":"high","expected_endpoint":"COMPLETE_SR","expected_stage_path":["splash_to_stage1","stage1_product1","stage2_product1","stage3_product1_feasibility","add_another_product_reset_to_stage1","stage1_product2","stage2_product2","stage3_product2_feasibility","stage4_contact_finalize"],"expected_tool_sequence":["productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment","productIntelligence","pricingIntelligence","visualConceptGeneration","feasibilityAssessment"],"persona_profile":{"what_they_want":"Bundle two products in one sourcing request.","what_they_know":"Has decent requirements for both products.","what_they_dont_know":"Combined landed-cost planning.","communication_style":"Structured and decisive.","trust_questions":["Can we combine requests in one flow?"],"dropoff_triggers":["Loses first product context","Cannot add second product cleanly"]},"hidden_truth":{"quantity":"1000 + 2000","budget":"viable","destination":"Philippines","timeline":"8 weeks","flexibility":"high","notes":"Validates multi-product reducer behavior."},"allowed_disclosures_by_turn":["T1-T4: completes first product path","T5: explicitly chooses add-another-product","T6+: provides second product then finalizes"],"must_pass_checks":["CK-003","CK-014","CK-016","CK-017","CK-015"],"must_fail_checks":[],"review_status":"draft","review_notes":"Flow-specific system test case.","sources":["README.md"],"behavior_bucket":"B4","bucket_pattern":"B4B","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity","destination","timeline","contact_email"],"linked_transcripts":[{"transcript_id":"TR-005","case_id":"GD-020","title":"Multi-product flow with add-another-product loop","profile_band":"high-intent multi-SKU ICP","goal":"Show product 1 completion, add-another-product reset, product 2 flow, then finalization.","expected_endpoint":"COMPLETE_SR","steps":[{"seq":1,"stage":"stage1","actor":"user","type":"message","text":"Need custom tote bags for event giveaways."},{"seq":2,"stage":"stage1","actor":"assistant","type":"message","text":"Great use case. Do you have a reference image? Upload one, or say skip so I can run product analysis."},{"seq":3,"stage":"stage1","actor":"user","type":"message","text":"Skip."},{"seq":4,"stage":"stage1","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"tote bag request (no image)"},{"seq":5,"stage":"stage1","actor":"assistant","type":"message","text":"Here are common options for this product. Pick what fits — or type specifics in chat."},{"seq":6,"stage":"stage1","actor":"user","type":"message","text":"Confirmed customizations: material=canvas, branding=screen print, color=beige."},{"seq":7,"stage":"stage1_to_stage2","actor":"system","type":"state_transition","state_update":"step1Complete=true, stage=2"},{"seq":8,"stage":"stage2","actor":"assistant","type":"message","text":"Building your offering now. I’ll run product, pricing, and concepts, then you can pick one."},{"seq":9,"stage":"stage2","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"product1 selected customizations"},{"seq":10,"stage":"stage2","actor":"system","type":"tool_call","tool":"pricingIntelligence","input_summary":"product1 pricing run"},{"seq":11,"stage":"stage2","actor":"system","type":"tool_call","tool":"visualConceptGeneration","input_summary":"product1 visual concepts"},{"seq":12,"stage":"stage2","actor":"assistant","type":"message","text":"Your offering is ready — $0.80-$1.20 DDP. Pick a visual concept below."},{"seq":13,"stage":"stage2_to_stage3","actor":"user","type":"message","text":"Picked concept 3. Let’s refine."},{"seq":14,"stage":"stage3","actor":"assistant","type":"message","text":"Great choice! Your estimate is $0.80-$1.20/unit. Fill in the details below to refine."},{"seq":15,"stage":"stage3","actor":"user","type":"message","text":"Quantity: 2000, Destination: Philippines, Timeline: 7 weeks"},{"seq":16,"stage":"stage3","actor":"system","type":"tool_call","tool":"feasibilityAssessment","input_summary":"product1 quantity/destination/timeline"},{"seq":17,"stage":"stage3","actor":"assistant","type":"message","text":"Feasibility looks good. Want to add another product to this request, or ready to finalize?"},{"seq":18,"stage":"stage3","actor":"user","type":"message","text":"Add another product."},{"seq":19,"stage":"stage3_to_stage1","actor":"assistant","type":"message","text":"Tell me about your next product, and share an image or link if you have one."},{"seq":20,"stage":"stage3_to_stage1","actor":"system","type":"state_transition","state_update":"SAVE_AND_ADD_PRODUCT; stage reset to 1"},{"seq":21,"stage":"stage1","actor":"user","type":"message","text":"Also need branded stainless tumblers."},{"seq":22,"stage":"stage1","actor":"assistant","type":"message","text":"Great add-on. Do you have a reference image? Upload one, or say skip so I can run product analysis."},{"seq":23,"stage":"stage1","actor":"user","type":"message","text":"[Reference image uploaded]"},{"seq":24,"stage":"stage1","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"tumbler request + imageBase64=pending"},{"seq":25,"stage":"stage1","actor":"assistant","type":"message","text":"Here are common options for this product. Pick what fits — or type specifics in chat."},{"seq":26,"stage":"stage1","actor":"user","type":"message","text":"Confirmed customizations: material=stainless, branding=laser logo, color=matte black."},{"seq":27,"stage":"stage1_to_stage2","actor":"system","type":"state_transition","state_update":"step1Complete=true, stage=2 (product2)"},{"seq":28,"stage":"stage2","actor":"assistant","type":"message","text":"Building your offering now. I’ll run product, pricing, and concepts, then you can pick one."},{"seq":29,"stage":"stage2","actor":"system","type":"tool_call","tool":"productIntelligence","input_summary":"product2 selected customizations"},{"seq":30,"stage":"stage2","actor":"system","type":"tool_call","tool":"pricingIntelligence","input_summary":"product2 pricing run"},{"seq":31,"stage":"stage2","actor":"system","type":"tool_call","tool":"visualConceptGeneration","input_summary":"product2 visual concepts"},{"seq":32,"stage":"stage2","actor":"assistant","type":"message","text":"Your offering is ready — $2.40-$3.40 DDP. Pick a visual concept below."},{"seq":33,"stage":"stage2_to_stage3","actor":"user","type":"message","text":"Concept 1 works. Continue."},{"seq":34,"stage":"stage3","actor":"assistant","type":"message","text":"Great choice! Your estimate is $2.40-$3.40/unit. Fill in the details below to refine."},{"seq":35,"stage":"stage3","actor":"user","type":"message","text":"Quantity: 1000, Destination: Philippines, Timeline: 8 weeks"},{"seq":36,"stage":"stage3","actor":"system","type":"tool_call","tool":"feasibilityAssessment","input_summary":"product2 quantity/destination/timeline"},{"seq":37,"stage":"stage3","actor":"assistant","type":"message","text":"Feasibility looks good. Want to add another product, or ready to finalize?"},{"seq":38,"stage":"stage3_to_stage4","actor":"user","type":"message","text":"Ready to finalize."},{"seq":39,"stage":"stage4","actor":"assistant","type":"message","text":"Let's finalize — please fill in your details below."},{"seq":40,"stage":"stage4","actor":"user","type":"message","text":"Name: Maria, Email: maria@brand.co, Company: Brand Co, Phone: +63..."},{"seq":41,"stage":"complete","actor":"assistant","type":"message","text":"Confirmed two products: tote bags + tumblers, with Philippines delivery. Request finalized for supplier quoting."}],"notes":["Demonstrates SAVE_AND_ADD_PRODUCT loop behavior.","Each product follows sequential tool order before feasibility.","Finalization happens only after explicit user confirmation."]}],"linked_transcript_count":1,"awsaf_priority_stars":4,"awsaf_priority_reason":"System behavior: multi-product add loop and finalize transition."},{"case_id":"GD-021","title":"Ghost lead says hi then disappears","persona_type":"non_sourcing_or_spam","motivation":"unclear_or_non_buyer","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"unclear","risk_class":"out_of_scope","intent_level":"low","expected_endpoint":"EDUCATE_AND_NURTURE","expected_stage_path":["splash_to_stage1","stage1_open_qualifier","lead_no_response_dropoff"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Unclear; often tests chat then vanishes.","what_they_know":"No specific product details provided.","what_they_dont_know":"Does not engage enough to define a request.","communication_style":"One-liner then silence.","trust_questions":["What do you do?"],"dropoff_triggers":["Too many follow-up questions","Long first response"]},"hidden_truth":{"quantity":"unknown","budget":"unknown","destination":"unknown","timeline":"unknown","flexibility":"none","notes":"Primary behavior is immediate inactivity after first qualifier."},"allowed_disclosures_by_turn":["T1: generic hello or vague sourcing mention","T2: no response"],"must_pass_checks":["CK-012","CK-015","CK-021"],"must_fail_checks":["CK-003","CK-011"],"review_status":"reviewed","review_notes":"Anchors true ghost behavior so it is not mis-scored as bot failure.","sources":["tests/run-v3-test/results/t-ghost.jsonl"],"behavior_bucket":"B1","bucket_pattern":"B1A","sourceability_status":"irrelevant","expected_dropoff_point":"after first qualifier","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-022","title":"Directionless lead says “you tell me, I am open”","persona_type":"non_sourcing_or_spam","motivation":"unclear_or_non_buyer","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"unclear","risk_class":"out_of_scope","intent_level":"low","expected_endpoint":"EDUCATE_AND_NURTURE","expected_stage_path":["splash_to_stage1","low_effort_scope_prompt","nurture_or_exit_if_still_vague"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Wants bot to drive topic instead of giving a sourcing brief.","what_they_know":"No concrete category commitment.","what_they_dont_know":"Minimum details required for sourcing.","communication_style":"Short, passive, non-committal.","trust_questions":["What should I source then?"],"dropoff_triggers":["Interrogation style questions","Complex onboarding text"]},"hidden_truth":{"quantity":"unknown","budget":"unknown","destination":"unknown","timeline":"unknown","flexibility":"low","notes":"Can be nurtured only if bot keeps burden low."},"allowed_disclosures_by_turn":["T1: says they are open to anything","T2: still avoids specifics"],"must_pass_checks":["CK-012","CK-020","CK-021"],"must_fail_checks":["CK-003","CK-011"],"review_status":"reviewed","review_notes":"Separates true directionless behavior from quality intent leads.","sources":["context/Trojan Horse Experiment_ WA Bot.md"],"behavior_bucket":"B1","bucket_pattern":"B1B","sourceability_status":"irrelevant","expected_dropoff_point":"after low-effort guidance prompt","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-023","title":"Branded reseller asks for AirPods-style product at low volume","persona_type":"sourcing_text_only","motivation":"find_cheaper","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"partial","risk_class":"ip_branded","intent_level":"medium","expected_endpoint":"EXIT_POLITE","expected_stage_path":["splash_to_stage1","brand_ip_restriction","safe_alternative_offer","polite_exit"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Resell branded electronics quickly for margin.","what_they_know":"Knows brand demand and resale logic.","what_they_dont_know":"Brand/IP sourcing boundaries and MOQ economics.","communication_style":"Direct and price-focused.","trust_questions":["Can you get original branded units cheaper?"],"dropoff_triggers":["Lecturing legal text","No actionable alternative"]},"hidden_truth":{"quantity":"50-100 units","budget":"tight reseller margin","destination":"SEA","timeline":"immediate","flexibility":"low","notes":"Structurally incompatible with Sourcy operating model."},"allowed_disclosures_by_turn":["T1: requests branded item","T2: states low-volume reseller plan"],"must_pass_checks":["CK-007","CK-015","CK-018","CK-020"],"must_fail_checks":["CK-003","CK-011"],"review_status":"locked","review_notes":"Must cleanly decline branded/IP path without inventing capabilities.","sources":["context/Bad/bad example 4.txt"],"behavior_bucket":"B5","bucket_pattern":"B5B","sourceability_status":"blocked","expected_dropoff_point":"after branded/IP restriction and alternatives","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-024","title":"Student hobby buyer asks tiny MOQ for candle supplies","persona_type":"sourcing_text_only","motivation":"start_business","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"clear","risk_class":"out_of_scope","intent_level":"low","expected_endpoint":"EXIT_POLITE","expected_stage_path":["splash_to_stage1","small_moq_economics_explained","local_alternative_exit"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Beginner-level supplies in very small quantities.","what_they_know":"Knows exact tiny quantities needed.","what_they_dont_know":"International shipping dominates cost at this volume.","communication_style":"Polite, practical, short.","trust_questions":["Can I start with 10-30 pieces?"],"dropoff_triggers":["Condescending tone","No local alternative suggestions"]},"hidden_truth":{"quantity":"10-35 units per item","budget":"very low","destination":"Pakistan","timeline":"immediate","flexibility":"none","notes":"Engaged but incompatible with B2B sourcing economics."},"allowed_disclosures_by_turn":["T1: asks for candle components","T2: reveals tiny quantities and student status"],"must_pass_checks":["CK-008","CK-015","CK-020"],"must_fail_checks":["CK-003","CK-011"],"review_status":"locked","review_notes":"Protects mismatch handling quality under polite tone constraints.","sources":["context/Bad/bad example 1.txt"],"behavior_bucket":"B5","bucket_pattern":"B5A","sourceability_status":"blocked","expected_dropoff_point":"after MOQ/shipping economics explained","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-025","title":"Hostile irrelevant request (spam + abuse)","persona_type":"non_sourcing_or_spam","motivation":"unclear_or_non_buyer","product_mode":"existing_no_custom","input_mode":"text","spec_clarity":"unclear","risk_class":"out_of_scope","intent_level":"low","expected_endpoint":"EXIT_POLITE","expected_stage_path":["splash_to_stage1","safe_boundary_response","polite_exit"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"No sourcing intent; attempts provocation.","what_they_know":"N/A","what_they_dont_know":"N/A","communication_style":"Hostile and irrelevant.","trust_questions":[],"dropoff_triggers":["Any escalation from bot","Moralizing response"]},"hidden_truth":{"quantity":"none","budget":"none","destination":"none","timeline":"none","flexibility":"none","notes":"Bot should remain professional and close quickly."},"allowed_disclosures_by_turn":["T1: irrelevant hostile message","T2: may repeat abuse or leave"],"must_pass_checks":["CK-020","CK-024","CK-015"],"must_fail_checks":["CK-003","CK-011"],"review_status":"reviewed","review_notes":"Prevents hostile traffic from polluting sourcing workflow and compute.","sources":["context/Bad/bad example 2.txt"],"behavior_bucket":"B6","bucket_pattern":"B6B","sourceability_status":"irrelevant","expected_dropoff_point":"after first boundary response","required_fields_for_sr":[],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-026","title":"ICP lead asks for call and provides website + email quickly","persona_type":"sourcing_moq_price_first","motivation":"expand_business","product_mode":"light_customization","input_mode":"mixed","spec_clarity":"clear","risk_class":"normal","intent_level":"high","expected_endpoint":"HUMAN_HANDOFF","expected_stage_path":["splash_to_stage1","call_request_received","light_qualification","handoff_confirmed"],"expected_tool_sequence":[],"persona_profile":{"what_they_want":"Procurement-style fast path with scheduled human call.","what_they_know":"Clear product family, quantities, and business identity.","what_they_dont_know":"Best factory path and landed optimization.","communication_style":"Structured, decisive, business-like.","trust_questions":["Can we schedule Zoom tomorrow?","Who will join call?"],"dropoff_triggers":["Call denied","Repeated chatbot-only forcing"]},"hidden_truth":{"quantity":"5,000+","budget":"viable","destination":"Philippines","timeline":"urgent","flexibility":"high","notes":"Should be treated as ICP despite preference for call-first flow."},"allowed_disclosures_by_turn":["T1: asks for call with product category","T2: provides email + website + available slots"],"must_pass_checks":["CK-010","CK-012","CK-015","CK-023"],"must_fail_checks":["CK-018"],"review_status":"reviewed","review_notes":"Represents strongest ICP-leaning call workflow for handoff quality.","sources":["context/Good/P1 PH leads asking for a call.txt"],"behavior_bucket":"B4","bucket_pattern":"B4A","sourceability_status":"sourceable","expected_dropoff_point":null,"required_fields_for_sr":["product","quantity","contact_email_or_call_slot","company_identity"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""},{"case_id":"GD-027","title":"Responsive lead jumps between finished goods, packaging, and logistics","persona_type":"sourcing_moq_price_first","motivation":"expand_business","product_mode":"light_customization","input_mode":"text","spec_clarity":"partial","risk_class":"normal","intent_level":"medium","expected_endpoint":"QUALIFY_AND_ADVANCE","expected_stage_path":["splash_to_stage1","scope_alignment_on_primary_item","stage1_product_intelligence","stage2_pricing_alignment"],"expected_tool_sequence":["productIntelligence","pricingIntelligence"],"persona_profile":{"what_they_want":"One supplier conversation for finished product + packaging + shipping answers.","what_they_know":"Knows category and some specs, but mixes scopes rapidly.","what_they_dont_know":"How to sequence sourcing decisions by dependency.","communication_style":"Responsive but jumps layers each turn.","trust_questions":["Can you price bottle + liquid + label + doorstep all at once?"],"dropoff_triggers":["Bot answers wrong scope","No clear next-step structure"]},"hidden_truth":{"quantity":"1,000-3,000","budget":"partial","destination":"Pakistan","timeline":"6-8 weeks","flexibility":"medium","notes":"Should progress if bot anchors one scope and sequences decisions clearly."},"allowed_disclosures_by_turn":["T1: asks MOQ/price with mixed scope","T2: switches between packaging and finished goods","T3: provides quantity if bot stabilizes scope"],"must_pass_checks":["CK-001","CK-002","CK-005","CK-008","CK-015","CK-022"],"must_fail_checks":["CK-018"],"review_status":"reviewed","review_notes":"Directly captures scope-jump behavior seen in handwash and similar threads.","sources":["context/Good/handwash SR.txt"],"behavior_bucket":"B2","bucket_pattern":"B2C","sourceability_status":"nurture","expected_dropoff_point":"if scope remains mixed after stabilization attempts","required_fields_for_sr":["primary_product_scope","quantity_or_budget","destination"],"linked_transcripts":[],"linked_transcript_count":0,"awsaf_priority_stars":0,"awsaf_priority_reason":""}],"checks":[{"id":"CK-001","title":"Stage 1 asks image before tools","description":"Bot asks for reference image first and does not call tools on the first product message.","severity":"high"},{"id":"CK-002","title":"Stage 1 runs PI after image or skip","description":"After image upload or skip response, bot immediately calls productIntelligence.","severity":"high"},{"id":"CK-003","title":"Stage 2 tool order","description":"Tool order is productIntelligence -> pricingIntelligence -> visualConceptGeneration.","severity":"critical"},{"id":"CK-004","title":"No pricing/visual before step1Complete","description":"pricingIntelligence and visualConceptGeneration are not called while step1Complete is false.","severity":"critical"},{"id":"CK-005","title":"Value-first trust handling","description":"Trust questions are answered directly and concretely before heavy intake.","severity":"high"},{"id":"CK-006","title":"Restricted hold absolute","description":"Restricted categories are held firm even under user pushback.","severity":"critical"},{"id":"CK-007","title":"Branded/IP hold","description":"Branded or IP-protected requests are declined with compliant alternatives.","severity":"critical"},{"id":"CK-008","title":"Budget math honesty","description":"Budget/quantity math is realistic and not manipulated for conversion.","severity":"critical"},{"id":"CK-009","title":"Currency disambiguation","description":"Ambiguous local currencies are clarified before hard conclusions.","severity":"high"},{"id":"CK-010","title":"Call handoff behavior","description":"When user asks for call/human, bot offers valid handoff without denial.","severity":"high"},{"id":"CK-011","title":"Contact collection only in Stage 4","description":"Bot does not ask contact details before Stage 4.","severity":"critical"},{"id":"CK-012","title":"Concise message discipline","description":"Messages respect short transition text and avoid card data duplication.","severity":"medium"},{"id":"CK-013","title":"No card data repetition","description":"Bot text does not repeat detailed numbers already shown in cards.","severity":"medium"},{"id":"CK-014","title":"Feasibility after structured form","description":"When quantity/destination/timeline form is submitted, feasibilityAssessment is called immediately.","severity":"high"},{"id":"CK-015","title":"Endpoint correctness","description":"Conversation outcome matches the gold expected endpoint.","severity":"critical"},{"id":"CK-016","title":"Add-another-product loop","description":"Add-another-product resets to Stage 1 while preserving completed products.","severity":"high"},{"id":"CK-017","title":"Finalize path correctness","description":"Finalize request transitions to Stage 4 and contact form flow.","severity":"high"},{"id":"CK-018","title":"No fabricated capabilities","description":"Bot does not invent unavailable artifacts, guarantees, or unsupported operations.","severity":"critical"},{"id":"CK-019","title":"Correction re-analysis","description":"When user corrects product/spec mismatch, bot triggers fresh product analysis.","severity":"high"},{"id":"CK-020","title":"Low-intent handling","description":"Low-intent or non-buyer cases are exited politely with clear redirect.","severity":"high"},{"id":"CK-021","title":"Low-intent dropoff handling","description":"For ghost or directionless users, bot sends one concise qualifier and avoids forced interrogation.","severity":"high"},{"id":"CK-022","title":"Scope-jump stabilization","description":"When user mixes finished goods/packaging/logistics, bot anchors one scope and proceeds without confusion.","severity":"high"},{"id":"CK-023","title":"Early-stage business acceptance","description":"Bot does not reject responsive high-intent users solely for missing website/registered company.","severity":"high"},{"id":"CK-024","title":"Hostile-safe exit","description":"Bot stays professional and exits safely on hostile irrelevant requests without escalating tone.","severity":"critical"}],"eval_comparison":{"dataset_name":"golden-eugene-v1-eval-comparison","version":"0.3.0","generated_at":"2026-02-23T07:22:06.631Z","threshold":{"quality_average_min":7,"required_check_fail_max":0,"endpoint_match_required":true},"judge_mode":"same-definition-heuristic-v1 (shared evaluator for Awsaf and Eric)","notes":["Both sets are scored with the same turn-quality rubric and the same required-check logic.","Required checks come from each mapped case's must_pass_checks in cases.seed.json.","Eric examples are mapped to GD cases to enforce endpoint and policy alignment under one definition.","Awsaf baseline reference (v0.1) is included to show post-improvement transcript lift after rerun."],"framework":{"source_checks_file":"tests/golden-eugene-v1/cases.seed.json","check_ids":["CK-001","CK-002","CK-003","CK-004","CK-005","CK-006","CK-007","CK-008","CK-009","CK-010","CK-011","CK-012","CK-013","CK-014","CK-015","CK-016","CK-017","CK-018","CK-019","CK-020","CK-021","CK-022","CK-023","CK-024"],"scoring_formula":"composite = 0.6 * quality_average + 0.4 * check_score"},"mappings":{"eric_case_map":{"v7-jesus.jsonl":"GD-017","v7-syed.jsonl":"GD-005","v7-battery.jsonl":"GD-016","v7-candle.jsonl":"GD-024","v7-anthony.jsonl":"GD-023","v7-jammaica.jsonl":"GD-007"}},"awsaf_baseline_v01":{"quality_average":6.9,"check_average":8.67,"composite_average":7.61,"pass_rate":60,"endpoint_match_rate":80},"awsaf_delta_vs_v01":{"quality_average":1.05,"check_average":1.33,"composite_average":1.16,"pass_rate":40,"endpoint_match_rate":20},"groups":[{"label":"Awsaf Golden Transcripts","source":"tests/golden-eugene-v1/transcripts.seed.json","count":5,"quality_average":7.95,"check_average":10,"composite_average":8.77,"pass_rate":100,"endpoint_match_rate":100,"items":[{"conversation_id":"TR-001","title":"Spam / Non-sourcing redirect","source_group":"Awsaf","source_file":"tests/golden-eugene-v1/transcripts.seed.json","case_id":"GD-001","expected_endpoint":"EXIT_POLITE","actual_endpoint":"EXIT_POLITE","endpoint_match":true,"assistant_turns":2,"quality_average":8,"required_checks":[{"id":"CK-012","result":true},{"id":"CK-015","result":true},{"id":"CK-020","result":true}],"required_checks_pass":3,"required_checks_fail":0,"required_checks_na":0,"required_check_pass_rate":100,"check_score":10,"composite_score":8.8,"pass":true,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":4,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}}],"improvement_suggestions":["Maintain this pattern as golden. Keep concise transition messages with explicit next-step cues."]},{"conversation_id":"TR-002","title":"Image-led medium-intent founder flow","source_group":"Awsaf","source_file":"tests/golden-eugene-v1/transcripts.seed.json","case_id":"GD-013","expected_endpoint":"COMPLETE_SR","actual_endpoint":"COMPLETE_SR","endpoint_match":true,"assistant_turns":8,"quality_average":7.88,"required_checks":[{"id":"CK-002","result":true},{"id":"CK-003","result":true},{"id":"CK-008","result":true},{"id":"CK-015","result":true},{"id":"CK-017","result":true}],"required_checks_pass":5,"required_checks_fail":0,"required_checks_na":0,"required_check_pass_rate":100,"check_score":10,"composite_score":8.73,"pass":true,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":6,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":9,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":18,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":20,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":24,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":26,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":28,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}}],"improvement_suggestions":["Maintain this pattern as golden. Keep concise transition messages with explicit next-step cues."]},{"conversation_id":"TR-003","title":"High-intent link-led ICP flow","source_group":"Awsaf","source_file":"tests/golden-eugene-v1/transcripts.seed.json","case_id":"GD-010","expected_endpoint":"COMPLETE_SR","actual_endpoint":"COMPLETE_SR","endpoint_match":true,"assistant_turns":8,"quality_average":7.88,"required_checks":[{"id":"CK-001","result":true},{"id":"CK-002","result":true},{"id":"CK-003","result":true},{"id":"CK-014","result":true},{"id":"CK-017","result":true},{"id":"CK-015","result":true}],"required_checks_pass":6,"required_checks_fail":0,"required_checks_na":0,"required_check_pass_rate":100,"check_score":10,"composite_score":8.73,"pass":true,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":5,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":8,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":14,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":16,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":20,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":22,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":24,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}}],"improvement_suggestions":["Maintain this pattern as golden. Keep concise transition messages with explicit next-step cues."]},{"conversation_id":"TR-004","title":"Restricted battery request with pushback","source_group":"Awsaf","source_file":"tests/golden-eugene-v1/transcripts.seed.json","case_id":"GD-016","expected_endpoint":"EXIT_POLITE","actual_endpoint":"EXIT_POLITE","endpoint_match":true,"assistant_turns":5,"quality_average":8.2,"required_checks":[{"id":"CK-006","result":true},{"id":"CK-012","result":true},{"id":"CK-015","result":true}],"required_checks_pass":3,"required_checks_fail":0,"required_checks_na":0,"required_check_pass_rate":100,"check_score":10,"composite_score":8.92,"pass":true,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":8,"dimensions":{"D1":2,"D2":1,"D3":1,"D4":2,"D5":2}},{"seq":6,"score":9,"dimensions":{"D1":2,"D2":2,"D3":1,"D4":2,"D5":2}},{"seq":8,"score":8,"dimensions":{"D1":2,"D2":1,"D3":1,"D4":2,"D5":2}},{"seq":9,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":11,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}}],"improvement_suggestions":["Maintain this pattern as golden. Keep concise transition messages with explicit next-step cues."]},{"conversation_id":"TR-005","title":"Multi-product flow with add-another-product loop","source_group":"Awsaf","source_file":"tests/golden-eugene-v1/transcripts.seed.json","case_id":"GD-020","expected_endpoint":"COMPLETE_SR","actual_endpoint":"COMPLETE_SR","endpoint_match":true,"assistant_turns":15,"quality_average":7.8,"required_checks":[{"id":"CK-003","result":true},{"id":"CK-014","result":true},{"id":"CK-016","result":true},{"id":"CK-017","result":true},{"id":"CK-015","result":true}],"required_checks_pass":5,"required_checks_fail":0,"required_checks_na":0,"required_check_pass_rate":100,"check_score":10,"composite_score":8.68,"pass":true,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":5,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":8,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":12,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":14,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":17,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":19,"score":6,"dimensions":{"D1":2,"D2":0,"D3":0,"D4":2,"D5":2}},{"seq":22,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":25,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":28,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":32,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":34,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}},{"seq":37,"score":9,"dimensions":{"D1":2,"D2":1,"D3":2,"D4":2,"D5":2}},{"seq":39,"score":7,"dimensions":{"D1":2,"D2":1,"D3":0,"D4":2,"D5":2}},{"seq":41,"score":8,"dimensions":{"D1":2,"D2":2,"D3":0,"D4":2,"D5":2}}],"improvement_suggestions":["Maintain this pattern as golden. Keep concise transition messages with explicit next-step cues."]}]},{"label":"Eric Chat Examples (v7)","source":"tests/run-v7/results/*.jsonl","count":6,"quality_average":6.28,"check_average":7.64,"composite_average":6.82,"pass_rate":16.67,"endpoint_match_rate":66.67,"items":[{"conversation_id":"v7-jesus","title":"v7-jesus","source_group":"Eric","source_file":"tests/run-v7/results/v7-jesus.jsonl","case_id":"GD-017","expected_endpoint":"COMPLETE_SR","actual_endpoint":"QUALIFY_AND_ADVANCE","endpoint_match":false,"assistant_turns":3,"quality_average":6.67,"required_checks":[{"id":"CK-005","result":true},{"id":"CK-008","result":true},{"id":"CK-009","result":true},{"id":"CK-014","result":null},{"id":"CK-017","result":null},{"id":"CK-015","result":false}],"required_checks_pass":3,"required_checks_fail":1,"required_checks_na":2,"required_check_pass_rate":75,"check_score":7.5,"composite_score":7,"pass":false,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":6,"dimensions":{"D1":2,"D2":0,"D3":2,"D4":2,"D5":0}},{"seq":4,"score":8,"dimensions":{"D1":2,"D2":2,"D3":2,"D4":2,"D5":0}},{"seq":6,"score":6,"dimensions":{"D1":1,"D2":2,"D3":2,"D4":1,"D5":0}}],"improvement_suggestions":["Endpoint mismatch: expected COMPLETE_SR, got QUALIFY_AND_ADVANCE. End with explicit COMPLETE_SR behavior.","Fix CK-015: Align ending behavior with expected endpoint.","Increase concrete value per turn (constraint, range, or rationale).","End each assistant turn with clear next-step language."]},{"conversation_id":"v7-syed","title":"v7-syed","source_group":"Eric","source_file":"tests/run-v7/results/v7-syed.jsonl","case_id":"GD-005","expected_endpoint":"EXIT_POLITE","actual_endpoint":"QUALIFY_AND_ADVANCE","endpoint_match":false,"assistant_turns":2,"quality_average":7,"required_checks":[{"id":"CK-001","result":null},{"id":"CK-002","result":null},{"id":"CK-003","result":null},{"id":"CK-008","result":true},{"id":"CK-014","result":null},{"id":"CK-015","result":false}],"required_checks_pass":1,"required_checks_fail":1,"required_checks_na":4,"required_check_pass_rate":50,"check_score":5,"composite_score":6.2,"pass":false,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":7,"dimensions":{"D1":0,"D2":2,"D3":2,"D4":1,"D5":2}},{"seq":4,"score":7,"dimensions":{"D1":0,"D2":2,"D3":2,"D4":1,"D5":2}}],"improvement_suggestions":["Endpoint mismatch: expected EXIT_POLITE, got QUALIFY_AND_ADVANCE. End with explicit EXIT_POLITE behavior.","Fix CK-015: Align ending behavior with expected endpoint."]},{"conversation_id":"v7-battery","title":"v7-battery","source_group":"Eric","source_file":"tests/run-v7/results/v7-battery.jsonl","case_id":"GD-016","expected_endpoint":"EXIT_POLITE","actual_endpoint":"EXIT_POLITE","endpoint_match":true,"assistant_turns":2,"quality_average":5,"required_checks":[{"id":"CK-006","result":true},{"id":"CK-012","result":false},{"id":"CK-015","result":true}],"required_checks_pass":2,"required_checks_fail":1,"required_checks_na":0,"required_check_pass_rate":66.67,"check_score":6.67,"composite_score":5.67,"pass":false,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":5,"dimensions":{"D1":0,"D2":1,"D3":2,"D4":1,"D5":1}},{"seq":4,"score":5,"dimensions":{"D1":0,"D2":2,"D3":2,"D4":0,"D5":1}}],"improvement_suggestions":["Fix CK-012: Shorten messages to concise transition style.","Shorten longer assistant turns; keep under transition-length target.","Increase concrete value per turn (constraint, range, or rationale).","Reduce multi-branch wording; keep one move per turn.","End each assistant turn with clear next-step language."]},{"conversation_id":"v7-candle","title":"v7-candle","source_group":"Eric","source_file":"tests/run-v7/results/v7-candle.jsonl","case_id":"GD-024","expected_endpoint":"EXIT_POLITE","actual_endpoint":"EXIT_POLITE","endpoint_match":true,"assistant_turns":2,"quality_average":5.5,"required_checks":[{"id":"CK-008","result":null},{"id":"CK-015","result":true},{"id":"CK-020","result":null}],"required_checks_pass":1,"required_checks_fail":0,"required_checks_na":2,"required_check_pass_rate":100,"check_score":10,"composite_score":7.3,"pass":false,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":6,"dimensions":{"D1":1,"D2":2,"D3":1,"D4":2,"D5":0}},{"seq":4,"score":5,"dimensions":{"D1":0,"D2":2,"D3":0,"D4":1,"D5":2}}],"improvement_suggestions":["Shorten longer assistant turns; keep under transition-length target.","Add one qualification/routing question where flow allows.","Reduce multi-branch wording; keep one move per turn.","End each assistant turn with clear next-step language.","Required checks are passing; focus on per-turn quality lift above 7.0."]},{"conversation_id":"v7-anthony","title":"v7-anthony","source_group":"Eric","source_file":"tests/run-v7/results/v7-anthony.jsonl","case_id":"GD-023","expected_endpoint":"EXIT_POLITE","actual_endpoint":"EXIT_POLITE","endpoint_match":true,"assistant_turns":2,"quality_average":7.5,"required_checks":[{"id":"CK-007","result":true},{"id":"CK-015","result":true},{"id":"CK-018","result":true},{"id":"CK-020","result":null}],"required_checks_pass":3,"required_checks_fail":0,"required_checks_na":1,"required_check_pass_rate":100,"check_score":10,"composite_score":8.5,"pass":true,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":9,"dimensions":{"D1":2,"D2":2,"D3":2,"D4":2,"D5":1}},{"seq":4,"score":6,"dimensions":{"D1":1,"D2":2,"D3":2,"D4":1,"D5":0}}],"improvement_suggestions":["Maintain this pattern as golden. Keep concise transition messages with explicit next-step cues."]},{"conversation_id":"v7-jammaica","title":"v7-jammaica","source_group":"Eric","source_file":"tests/run-v7/results/v7-jammaica.jsonl","case_id":"GD-007","expected_endpoint":"HUMAN_HANDOFF","actual_endpoint":"HUMAN_HANDOFF","endpoint_match":true,"assistant_turns":1,"quality_average":6,"required_checks":[{"id":"CK-010","result":true},{"id":"CK-012","result":false},{"id":"CK-015","result":true}],"required_checks_pass":2,"required_checks_fail":1,"required_checks_na":0,"required_check_pass_rate":66.67,"check_score":6.67,"composite_score":6.27,"pass":false,"score_mode":"same-definition-heuristic-v1","turn_scores":[{"seq":2,"score":6,"dimensions":{"D1":1,"D2":2,"D3":2,"D4":1,"D5":0}}],"improvement_suggestions":["Fix CK-012: Shorten messages to concise transition style.","Shorten longer assistant turns; keep under transition-length target.","Reduce multi-branch wording; keep one move per turn.","End each assistant turn with clear next-step language."]}]}]},"coverage":{"behavior_bucket":{"B6":3,"B5":5,"B2":6,"B3":6,"B4":5,"B1":2},"persona_type":{"non_sourcing_or_spam":7,"sourcing_moq_price_first":6,"sourcing_with_alibaba_link":4,"sourcing_with_image_reference":4,"sourcing_text_only":6},"motivation":{"unclear_or_non_buyer":6,"start_business":8,"expand_business":9,"find_cheaper":4},"product_mode":{"existing_no_custom":14,"light_customization":11,"net_new_invention":1,"custom_mold":1},"input_mode":{"text":17,"link":2,"mixed":4,"image":4},"risk_class":{"out_of_scope":7,"normal":18,"restricted":1,"ip_branded":1},"expected_endpoint":{"EXIT_POLITE":7,"EDUCATE_AND_NURTURE":5,"QUALIFY_AND_ADVANCE":6,"COMPLETE_SR":6,"HUMAN_HANDOFF":3},"review_status":{"locked":11,"reviewed":13,"draft":3}},"matrix":{"rows":["non_sourcing_or_spam","sourcing_moq_price_first","sourcing_text_only","sourcing_with_alibaba_link","sourcing_with_image_reference"],"cols":["custom_mold","existing_no_custom","light_customization","net_new_invention"],"values":{"non_sourcing_or_spam":{"custom_mold":0,"existing_no_custom":7,"light_customization":0,"net_new_invention":0},"sourcing_moq_price_first":{"custom_mold":0,"existing_no_custom":1,"light_customization":5,"net_new_invention":0},"sourcing_text_only":{"custom_mold":1,"existing_no_custom":3,"light_customization":1,"net_new_invention":1},"sourcing_with_alibaba_link":{"custom_mold":0,"existing_no_custom":1,"light_customization":3,"net_new_invention":0},"sourcing_with_image_reference":{"custom_mold":0,"existing_no_custom":2,"light_customization":2,"net_new_invention":0}}},"transcripts_count":5,"transcripts_tool_calls":21,"priority_list":[{"case_id":"GD-001","title":"Job seeker asks how to apply","stars":5,"reason":"Non-buyer guardrail: proves polite scope control without wasting tools.","expected_endpoint":"EXIT_POLITE","review_status":"locked","linked_transcript_count":1},{"case_id":"GD-013","title":"Teen jewelry founder sends image references","stars":5,"reason":"Mid-intent image-led: validates full stage choreography and conversion hygiene.","expected_endpoint":"COMPLETE_SR","review_status":"locked","linked_transcript_count":1},{"case_id":"GD-010","title":"UK dog harness with Alibaba link and clear MOQ","stars":5,"reason":"High-intent ICP: clean path to complete SR with correct tool ordering.","expected_endpoint":"COMPLETE_SR","review_status":"locked","linked_transcript_count":1},{"case_id":"GD-016","title":"Image and text indicate restricted battery request","stars":4,"reason":"Compliance lock: restricted-category hold under pushback.","expected_endpoint":"EXIT_POLITE","review_status":"locked","linked_transcript_count":1},{"case_id":"GD-020","title":"Multi-product flow with add-another-product loop","stars":4,"reason":"System behavior: multi-product add loop and finalize transition.","expected_endpoint":"COMPLETE_SR","review_status":"draft","linked_transcript_count":1}]}</script>
  <script>
    (function () {
      const data = JSON.parse(document.getElementById("seed").textContent);
      const cases = data.cases || [];
      const checks = data.checks || [];
      const priority = data.priority_list || [];
      const checkMap = Object.fromEntries(checks.map((c) => [c.id, c.title]));
      let currentId = null;

      const caseListEl = document.getElementById("caseList");
      const caseDetailEl = document.getElementById("caseDetail");
      const heroMeta = document.getElementById("heroMeta");
      const priorityGrid = document.getElementById("priorityGrid");

      const fPersona = document.getElementById("fPersona");
      const fMotivation = document.getElementById("fMotivation");
      const fProductMode = document.getElementById("fProductMode");
      const fRisk = document.getElementById("fRisk");
      const fStatus = document.getElementById("fStatus");
      const fTranscript = document.getElementById("fTranscript");
      const fSearch = document.getElementById("fSearch");

      function uniq(values) {
        return Array.from(new Set(values)).sort((a, b) => a.localeCompare(b));
      }

      function fillSelect(el, values, allLabel) {
        el.innerHTML = "";
        const all = document.createElement("option");
        all.value = "all";
        all.textContent = allLabel;
        el.appendChild(all);
        values.forEach((v) => {
          const op = document.createElement("option");
          op.value = v;
          op.textContent = v;
          el.appendChild(op);
        });
      }

      function statusClass(status) {
        if (status === "locked") return "locked";
        if (status === "reviewed") return "reviewed";
        return "draft";
      }

      function statusLabel(status) {
        if (status === "locked") return "Ready for eval";
        if (status === "reviewed") return "Needs team decision";
        return "Needs definition";
      }

      function stars(n) {
        if (!n) return "";
        return "★".repeat(n) + "☆".repeat(Math.max(0, 5 - n));
      }

      function renderCoverage(id, obj) {
        const el = document.getElementById(id);
        el.innerHTML = "";
        Object.keys(obj).sort((a, b) => a.localeCompare(b)).forEach((k) => {
          const span = document.createElement("span");
          span.className = "tag";
          span.textContent = k + ": " + obj[k];
          el.appendChild(span);
        });
      }

      function renderPriority() {
        priorityGrid.innerHTML = "";
        if (!priority.length) {
          priorityGrid.innerHTML = "<div class='card'>No priority list configured.</div>";
          return;
        }
        priority.forEach((p) => {
          const c = document.createElement("article");
          c.className = "card";
          c.innerHTML =
            "<div class='starline'>" + stars(p.stars) + "</div>" +
            "<div style='font-weight:700; margin-bottom:4px;'>" + p.case_id + " - " + p.title + "</div>" +
            "<div style='font-size:12px; color:#5b6767; margin-bottom:6px;'>" + p.reason + "</div>" +
            "<span class='tag " + statusClass(p.review_status) + "'>" + statusLabel(p.review_status) + "</span>" +
            "<span class='tag'>" + p.expected_endpoint + "</span>" +
            "<span class='tag'>transcripts: " + p.linked_transcript_count + "</span>";
          c.addEventListener("click", () => {
            currentId = p.case_id;
            render(filteredCases());
          });
          priorityGrid.appendChild(c);
        });
      }

      function renderHeatTable() {
        const m = data.matrix;
        const table = document.getElementById("heatTable");
        table.innerHTML = "";
        const thead = document.createElement("thead");
        const trh = document.createElement("tr");
        const th0 = document.createElement("th");
        th0.textContent = "persona_type";
        trh.appendChild(th0);
        m.cols.forEach((c) => {
          const th = document.createElement("th");
          th.textContent = c;
          trh.appendChild(th);
        });
        thead.appendChild(trh);
        table.appendChild(thead);

        const tbody = document.createElement("tbody");
        m.rows.forEach((r) => {
          const tr = document.createElement("tr");
          const td0 = document.createElement("td");
          td0.textContent = r;
          tr.appendChild(td0);
          m.cols.forEach((c) => {
            const td = document.createElement("td");
            td.textContent = String((m.values[r] && m.values[r][c]) || 0);
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
        table.appendChild(tbody);
      }

      function renderChecksTable() {
        const t = document.getElementById("checkTable");
        t.innerHTML = "";
        const thead = document.createElement("thead");
        thead.innerHTML = "<tr><th>ID</th><th>Title</th><th>Severity</th><th>Description</th></tr>";
        t.appendChild(thead);
        const tbody = document.createElement("tbody");
        checks.forEach((ch) => {
          const tr = document.createElement("tr");
          tr.innerHTML =
            "<td>" + ch.id + "</td>" +
            "<td>" + ch.title + "</td>" +
            "<td>" + ch.severity + "</td>" +
            "<td>" + ch.description + "</td>";
          tbody.appendChild(tr);
        });
        t.appendChild(tbody);
      }

      function renderSignoffTable() {
        const t = document.getElementById("signoffTable");
        t.innerHTML = "";
        const thead = document.createElement("thead");
        thead.innerHTML = "<tr><th>Case ID</th><th>Title</th><th>Status</th><th>Expected Endpoint</th><th>Linked Transcripts</th><th>Review Notes</th></tr>";
        t.appendChild(thead);
        const tbody = document.createElement("tbody");
        cases.forEach((c) => {
          const tr = document.createElement("tr");
          tr.innerHTML =
            "<td>" + c.case_id + "</td>" +
            "<td>" + c.title + "</td>" +
            "<td><span class='tag " + statusClass(c.review_status) + "'>" + statusLabel(c.review_status) + "</span></td>" +
            "<td>" + c.expected_endpoint + "</td>" +
            "<td>" + c.linked_transcript_count + "</td>" +
            "<td>" + c.review_notes + "</td>";
          tbody.appendChild(tr);
        });
        t.appendChild(tbody);
      }

      function filteredCases() {
        const q = (fSearch.value || "").toLowerCase().trim();
        return cases.filter((c) => {
          if (fPersona.value !== "all" && c.persona_type !== fPersona.value) return false;
          if (fMotivation.value !== "all" && c.motivation !== fMotivation.value) return false;
          if (fProductMode.value !== "all" && c.product_mode !== fProductMode.value) return false;
          if (fRisk.value !== "all" && c.risk_class !== fRisk.value) return false;
          if (fStatus.value !== "all" && c.review_status !== fStatus.value) return false;
          if (fTranscript.value === "with" && c.linked_transcript_count === 0) return false;
          if (fTranscript.value === "without" && c.linked_transcript_count > 0) return false;
          if (q) {
            const hay = (c.case_id + " " + c.title + " " + c.review_notes + " " + c.expected_endpoint).toLowerCase();
            if (!hay.includes(q)) return false;
          }
          return true;
        });
      }

      function renderCaseList(rows) {
        caseListEl.innerHTML = "";
        if (!rows.length) {
          caseListEl.innerHTML = "<div class='empty'>No cases match current filters.</div>";
          caseDetailEl.innerHTML = "<div class='empty'>No case selected.</div>";
          currentId = null;
          return;
        }

        if (!currentId || !rows.some((r) => r.case_id === currentId)) currentId = rows[0].case_id;

        rows.forEach((c) => {
          const div = document.createElement("div");
          div.className = "case-item" + (c.case_id === currentId ? " active" : "");
          div.innerHTML =
            "<div class='t'>" + c.case_id + " - " + c.title + "</div>" +
            "<div class='meta'>" + c.persona_type + " | " + c.motivation + " | " + c.expected_endpoint + "</div>" +
            (c.awsaf_priority_stars > 0 ? "<div class='starline'>" + stars(c.awsaf_priority_stars) + "</div>" : "") +
            "<span class='tag " + statusClass(c.review_status) + "'>" + statusLabel(c.review_status) + "</span>" +
            "<span class='tag'>" + c.risk_class + "</span>" +
            "<span class='tag'>" + c.input_mode + "</span>" +
            "<span class='tag'>transcripts: " + c.linked_transcript_count + "</span>";
          div.addEventListener("click", function () {
            currentId = c.case_id;
            render(rows);
          });
          caseListEl.appendChild(div);
        });
      }

      function renderChecks(ids) {
        if (!ids || !ids.length) return "<span class='tag'>none</span>";
        return ids.map((id) => "<span class='check' title='" + (checkMap[id] || "") + "'>" + id + " - " + (checkMap[id] || "Unknown check") + "</span>").join("");
      }

      function stepBody(s) {
        return s.text || s.input_summary || s.output_summary || s.state_update || "";
      }

      function toolUiHints(s) {
        const tool = s.tool || "";
        const stage = (s.stage || "").toLowerCase();
        if (tool === "productIntelligence") {
          if (stage.startsWith("stage1")) {
            return [
              "Chip selector appears with 3-4 groups (example: Material, Branding, Color).",
              "User can tap chips or type custom preferences."
            ];
          }
          return [
            "Spec card appears with product specs and MOQ guidance.",
            "Sourcy difference summary appears for quick positioning."
          ];
        }
        if (tool === "pricingIntelligence") {
          return [
            "Price comparison card appears: Alibaba FOB, landed, Sourcy DDP.",
            "Cost tips appear with actionable savings ideas.",
            "Reference listing links appear for market anchoring."
          ];
        }
        if (tool === "visualConceptGeneration") {
          return [
            "Visual gallery appears with 3 concepts (image + label + short description).",
            "User picks one concept to continue to Stage 3."
          ];
        }
        if (tool === "feasibilityAssessment") {
          return [
            "Feasibility card appears with status (green/yellow/red) and rationale.",
            "Post-feasibility actions appear: Add another product or Finalize request."
          ];
        }
        return [];
      }

      function messageUiHints(s) {
        const txt = (s.text || "").toLowerCase();
        if (s.actor !== "assistant") return [];
        if (txt.includes("do you have a reference image")) {
          return ["Next user action expected: upload reference image or type skip."];
        }
        if (txt.includes("here are common options for this product")) {
          return [
            "Customization chips are visible for quick selection.",
            "User can continue by confirming customizations."
          ];
        }
        if (txt.includes("pick a visual concept below")) {
          return ["Visual gallery is visible; one concept must be selected before refinement."];
        }
        if (txt.includes("fill in the details below to refine")) {
          return [
            "Structured refinement form appears.",
            "Fields shown: Quantity, Destination, Timeline."
          ];
        }
        if (txt.includes("want to add another product") || txt.includes("ready to finalize")) {
          return ["Two action buttons are shown: Add another product or Finalize request."];
        }
        if (txt.includes("let's finalize") && txt.includes("fill in your details below")) {
          return ["Contact form appears with Name, Email, Company, and Phone."];
        }
        return [];
      }

      function appendHints(parent, title, hints) {
        if (!hints || !hints.length) return;
        const box = document.createElement("div");
        box.className = "ui-preview";
        const head = document.createElement("div");
        head.className = "ui-preview-title";
        head.textContent = title;
        box.appendChild(head);
        const list = document.createElement("ul");
        list.className = "list-tight";
        hints.forEach((h) => {
          const li = document.createElement("li");
          li.textContent = h;
          list.appendChild(li);
        });
        box.appendChild(list);
        parent.appendChild(box);
      }

      function renderTranscriptStep(s) {
        const isUserMessage = s.type === "message" && s.actor === "user";
        const isAssistantMessage = s.type === "message" && s.actor === "assistant";
        const bodyText = stepBody(s);
        const line = document.createElement("div");

        if (isUserMessage || isAssistantMessage) {
          line.className = "chat-line " + (isUserMessage ? "user" : "assistant");
          const bubble = document.createElement("div");
          bubble.className = "chat-bubble " + (isUserMessage ? "user" : "assistant");
          const head = document.createElement("div");
          head.className = "chat-head";
          head.textContent =
            "#" + s.seq + " | " + s.stage + " | " + (isUserMessage ? "User message" : "Assistant message");
          const body = document.createElement("div");
          body.textContent = bodyText;
          bubble.appendChild(head);
          bubble.appendChild(body);
          appendHints(bubble, "UI After This Message", messageUiHints(s));
          line.appendChild(bubble);
          return line;
        }

        line.className = "chat-line internal";
        const card = document.createElement("div");
        card.className = "internal-card";
        if (s.type === "thinking") card.className += " thinking";
        if (s.type === "state_transition") card.className += " transition";

        const head = document.createElement("div");
        head.className = "chat-head";
        if (s.type === "tool_call") {
          head.textContent = "#" + s.seq + " | " + s.stage + " | Bot internal tool call | " + s.tool;
        } else if (s.type === "tool_result") {
          head.textContent = "#" + s.seq + " | " + s.stage + " | Tool result snapshot | " + s.tool;
        } else if (s.type === "thinking") {
          head.textContent = "#" + s.seq + " | " + s.stage + " | Assistant reasoning bridge";
        } else if (s.type === "state_transition") {
          head.textContent = "#" + s.seq + " | " + s.stage + " | System state transition";
        } else {
          head.textContent = "#" + s.seq + " | " + s.stage + " | " + s.actor + " | " + s.type;
        }

        const body = document.createElement("div");
        body.textContent = bodyText;
        card.appendChild(head);
        card.appendChild(body);

        if (s.type === "tool_call" || s.type === "tool_result") {
          appendHints(card, "What User Sees From This Tool", toolUiHints(s));
        }
        if (s.type === "state_transition") {
          appendHints(card, "UI Transition", ["Progress/stage state updates after this transition."]);
        }
        line.appendChild(card);
        return line;
      }

      function renderTranscript(t) {
        const wrap = document.createElement("article");
        wrap.className = "timeline-card";
        wrap.innerHTML =
          "<div class='timeline-title'>" + t.transcript_id + " - " + t.title + "</div>" +
          "<span class='tag'>" + t.profile_band + "</span>" +
          "<span class='tag'>" + t.expected_endpoint + "</span>";

        const goal = document.createElement("div");
        goal.style.margin = "8px 0";
        goal.style.fontSize = "13px";
        goal.style.color = "#4c5959";
        goal.innerHTML = "<strong>Goal:</strong> " + t.goal;
        wrap.appendChild(goal);

        const legend = document.createElement("div");
        legend.className = "transcript-legend";
        legend.innerHTML =
          "<span class='legend-pill user'>User message</span>" +
          "<span class='legend-pill assistant'>Assistant message</span>" +
          "<span class='legend-pill internal'>Bot internal tools</span>" +
          "<span class='legend-pill thinking'>Assistant reasoning</span>";
        wrap.appendChild(legend);

        (t.steps || []).forEach((s) => {
          wrap.appendChild(renderTranscriptStep(s));
        });

        if (t.notes && t.notes.length) {
          const n = document.createElement("div");
          n.style.fontSize = "13px";
          n.style.color = "#4c5959";
          n.innerHTML = "<strong>Transcript notes:</strong><ul class='list-tight'>" + t.notes.map((x) => "<li>" + x + "</li>").join("") + "</ul>";
          wrap.appendChild(n);
        }

        return wrap;
      }

      function renderDetail(c) {
        if (!c) {
          caseDetailEl.innerHTML = "<div class='empty'>Select a case to inspect details.</div>";
          return;
        }
        caseDetailEl.innerHTML = "";

        const head = document.createElement("div");
        head.className = "detail-head";
        head.innerHTML =
          "<h4>" + c.case_id + " - " + c.title + "</h4>" +
          (c.awsaf_priority_stars > 0 ? "<div class='starline'>" + stars(c.awsaf_priority_stars) + " Awsaf priority</div>" : "") +
          "<span class='tag " + statusClass(c.review_status) + "'>" + statusLabel(c.review_status) + "</span>" +
          "<span class='tag'>" + c.persona_type + "</span>" +
          "<span class='tag'>" + c.product_mode + "</span>" +
          "<span class='tag'>" + c.expected_endpoint + "</span>" +
          "<span class='tag'>" + c.intent_level + " intent</span>" +
          "<span class='tag'>transcripts: " + c.linked_transcript_count + "</span>" +
          (c.awsaf_priority_reason ? "<p style='margin:8px 0 0; font-size:13px; color:#4a5757;'><strong>Why first:</strong> " + c.awsaf_priority_reason + "</p>" : "");
        caseDetailEl.appendChild(head);

        const cols = document.createElement("div");
        cols.className = "cols";

        const boxA = document.createElement("section");
        boxA.className = "box";
        boxA.innerHTML =
          "<h5>Persona and Hidden Truth</h5>" +
          "<div class='body'>" +
          "<p><strong>Wants:</strong> " + c.persona_profile.what_they_want + "</p>" +
          "<p><strong>Knows:</strong> " + c.persona_profile.what_they_know + "</p>" +
          "<p><strong>Unknowns:</strong> " + c.persona_profile.what_they_dont_know + "</p>" +
          "<p><strong>Style:</strong> " + c.persona_profile.communication_style + "</p>" +
          "<p><strong>Hidden truth:</strong> quantity=" + c.hidden_truth.quantity + ", budget=" + c.hidden_truth.budget + ", destination=" + c.hidden_truth.destination + ", timeline=" + c.hidden_truth.timeline + "</p>" +
          "<p><strong>Flexibility:</strong> " + c.hidden_truth.flexibility + "</p>" +
          "</div>";
        cols.appendChild(boxA);

        const boxB = document.createElement("section");
        boxB.className = "box";
        boxB.innerHTML =
          "<h5>Expected Bot Flow</h5>" +
          "<div class='body'>" +
          "<p><strong>Stage path:</strong></p>" +
          "<ol class='list-tight'>" + c.expected_stage_path.map((s) => "<li>" + s + "</li>").join("") + "</ol>" +
          "<p><strong>Tool sequence:</strong></p>" +
          "<ol class='list-tight'>" + c.expected_tool_sequence.map((s) => "<li>" + s + "</li>").join("") + "</ol>" +
          "</div>";
        cols.appendChild(boxB);

        const boxC = document.createElement("section");
        boxC.className = "box";
        boxC.innerHTML =
          "<h5>Simulation Guide (Lead Behavior)</h5>" +
          "<div class='body'>" +
          "<p><strong>Turn-by-turn expected behavior (T1 = first lead reply, T2 = second):</strong></p>" +
          "<ol class='list-tight'>" + c.allowed_disclosures_by_turn.map((s) => "<li>" + s + "</li>").join("") + "</ol>" +
          "<p><strong>Disengagement risks if bot misses expectations:</strong></p>" +
          "<ul class='list-tight'>" + c.persona_profile.dropoff_triggers.map((s) => "<li>" + s + "</li>").join("") + "</ul>" +
          "<p><strong>Typical verification questions this lead asks:</strong></p>" +
          "<ul class='list-tight'>" + c.persona_profile.trust_questions.map((s) => "<li>" + s + "</li>").join("") + "</ul>" +
          "</div>";
        cols.appendChild(boxC);

        const boxD = document.createElement("section");
        boxD.className = "box";
        boxD.innerHTML =
          "<h5>Evaluation Checklist (What Good Looks Like)</h5>" +
          "<div class='body'>" +
          "<p><strong>Required checks (must pass):</strong><br/>" + renderChecks(c.must_pass_checks) + "</p>" +
          "<p><strong>Forbidden failures (must NOT happen):</strong><br/>" + renderChecks(c.must_fail_checks) + "</p>" +
          "<p><strong>Notes:</strong> " + c.review_notes + "</p>" +
          "<p><strong>Sources:</strong><br/>" + c.sources.map((s) => "<span class='tag'>" + s + "</span>").join("") + "</p>" +
          "</div>";
        cols.appendChild(boxD);

        caseDetailEl.appendChild(cols);

        const tWrap = document.createElement("section");
        tWrap.className = "timeline-wrap";
        tWrap.innerHTML = "<h5 style='margin:0 0 8px; font-size:15px;'>Linked Transcript(s)</h5>";

        if (!c.linked_transcripts || !c.linked_transcripts.length) {
          tWrap.innerHTML += "<div class='empty' style='padding:10px; border:1px dashed #cdbfa9; border-radius:10px; background:#fffdf8;'>No transcript linked for this case yet.</div>";
        } else {
          c.linked_transcripts.forEach((t) => tWrap.appendChild(renderTranscript(t)));
        }

        caseDetailEl.appendChild(tWrap);
      }

      function render(rows) {
        renderCaseList(rows);
        const current = rows.find((r) => r.case_id === currentId) || rows[0];
        renderDetail(current);
      }

      function initFilters() {
        fillSelect(fPersona, uniq(cases.map((c) => c.persona_type)), "All persona types");
        fillSelect(fMotivation, uniq(cases.map((c) => c.motivation)), "All motivations");
        fillSelect(fProductMode, uniq(cases.map((c) => c.product_mode)), "All product modes");
        fillSelect(fRisk, uniq(cases.map((c) => c.risk_class)), "All risk classes");
        fStatus.innerHTML = "";
        [
          { v: "all", t: "All review states" },
          { v: "locked", t: "Ready for eval" },
          { v: "reviewed", t: "Needs team decision" },
          { v: "draft", t: "Needs definition" }
        ].forEach((it) => {
          const op = document.createElement("option");
          op.value = it.v;
          op.textContent = it.t;
          fStatus.appendChild(op);
        });
        fTranscript.innerHTML = "";
        [
          { v: "all", t: "All cases" },
          { v: "with", t: "With transcript" },
          { v: "without", t: "Without transcript" }
        ].forEach((it) => {
          const op = document.createElement("option");
          op.value = it.v;
          op.textContent = it.t;
          fTranscript.appendChild(op);
        });
      }

      function wire() {
        [fPersona, fMotivation, fProductMode, fRisk, fStatus, fTranscript, fSearch].forEach((el) => {
          el.addEventListener("change", () => render(filteredCases()));
          el.addEventListener("input", () => render(filteredCases()));
        });
      }

      function initStatic() {
        heroMeta.textContent =
          data.dataset_name + " v" + data.version +
          " | purpose: " + data.generated_for;

        const locked = cases.filter((c) => c.review_status === "locked").length;
        const draft = cases.filter((c) => c.review_status === "draft").length;
        const linked = cases.filter((c) => c.linked_transcript_count > 0).length;

        document.getElementById("kCases").textContent = String(cases.length);
        document.getElementById("kTranscripts").textContent = String(data.transcripts_count || 0);
        document.getElementById("kLinked").textContent = String(linked);
        document.getElementById("kLocked").textContent = String(locked);
        document.getElementById("kDraft").textContent = String(draft);
        document.getElementById("kToolCalls").textContent = String(data.transcripts_tool_calls || 0);

        renderCoverage("coverageSegment", data.coverage.behavior_bucket || data.coverage.persona_type);
        renderCoverage("coverageEndpoint", data.coverage.expected_endpoint);
        renderHeatTable();
        renderChecksTable();
        renderSignoffTable();
        renderPriority();
      }

      initFilters();
      wire();
      initStatic();
      render(filteredCases());
    })();
  </script>
</body>
</html>